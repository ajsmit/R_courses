<!DOCTYPE html>
<html lang="en" dir="ltr"><head>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.96.0" />
<title>2. Biodiversity | BCB R Stats Pages</title>


<meta property="twitter:site" content="@ajsmit">
<meta property="twitter:creator" content="@ajsmit">







  
    
  
<meta name="description" content="What you need to know upfront.">


<meta property="og:site_name" content="BCB R Stats Pages">
<meta property="og:title" content="2. Biodiversity | BCB R Stats Pages">
<meta property="og:description" content="What you need to know upfront." />
<meta property="og:type" content="page" />
<meta property="og:url" content="/workshops/quantecol/chapters/02-biodiversity/" />
<meta property="og:locale" content="en">




    
        <meta property="og:image" content="/img/papillons.jpg" >
        <meta property="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="/img/papillons.jpg" >
    
  <meta itemprop="name" content="2. Biodiversity">
<meta itemprop="description" content="Three measures of biodiversity Three measures of biodiversity were coined by Whittaker in 1972. They represent the measurement of biodiversity across different spatial scales. α- and γ-diversity simply express the total number of species in an area. α-diversity is a representation of the number of species at the small (local) scale, such as within a quadrat, transect, plot, or trawl. Multiples of these are nested within a larger region (or ecosystem etc."><meta itemprop="datePublished" content="2021-01-01T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-01-01T00:00:00+00:00" />
<meta itemprop="wordCount" content="3271">
<meta itemprop="keywords" content="" />
  
  
  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.13dd27d3efb7ed4ad82be3040182ddbf5ab9d3b4d6d01f0ba3930845932fce66.css" integrity="sha256-E90n0&#43;&#43;37UrYK&#43;MEAYLdv1q507TW0B8Lo5MIRZMvzmY=" media="screen">
  
  
  <script src="/panelset.min.8f4cba0107356728f266d94a12a4d18ef504eda8a9a284cda73675bae7884a68.js" type="text/javascript"></script>
  
  
  <script src="/main.min.318ee9c0652bba0149e7503c97e37e638937f3a9cad9233e6d0ba00bf7a46a5e.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container single-series">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="/" title="Home">
      <img src="/img/xaringan-outline.png" class="dib db-l h2 w-auto" alt="BCB R Stats Pages">
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="About AJ Smit">About</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/workshops/" title="BCB Hons">BCB Hons</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/project/" title="Project Portfolio">Projects</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/collection/" title="R Courses">R Courses</a>
      
      
    </div>
  </nav>
</header>


<main class="page-main ph4 pt4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 pr3-l">
      <header class="post-header">
        <h4 class="breadcrumb pb5">

  
    
      
  
    
      
  
    
      
  

    
    
      <a href="/workshops/">B.Sc. (Hons.) R modules</a>
    
  

    
    
      <a href="/workshops/quantecol/">BCB743</a>
    
  

    
    
      2. Biodiversity
    
  

</h4>




        
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">2. Biodiversity</h1>
        
        <p class="f6 measure lh-copy mv1"></p>
        <p class="f7 db mv0 ttu">January 1, 2021</p>
        
        
      
        
      </header>
      <section class="post-body pt5 pb4">
        


<!--- # Topic 2: Biodiversity --->
<div id="three-measures-of-biodiversity" class="section level2">
<h2>Three measures of biodiversity</h2>
<p>Three measures of biodiversity were coined by Whittaker in 1972. They represent the measurement of biodiversity across different spatial scales. α- and γ-diversity simply express the total number of species in an area. α-diversity is a representation of the number of species at the small (local) scale, such as within a quadrat, transect, plot, or trawl. Multiples of these are nested within a larger region (or ecosystem etc.) and serve as replicates, and it is the complete number of species across all of these replicates that indicates the diversity at a larger scale—this is called γ-diversity.</p>
<p>β-diversity is something else, and will be discussed below.</p>
<p>We will use data on seaweed of South Africa to demonstrate these ideas.</p>
</div>
<div id="the-south-african-seaweed-data" class="section level1">
<h1>The South African seaweed data</h1>
<p>For this example we will use the seaweed data of Smit et al. (2017); please make sure that you read it! For information about the study, see:</p>
<p><a href="https://github.com/ajsmit/Quantitative_Ecology/blob/main/_GitBook/LaTeX/The_seaweed_data.pdf" class="uri">https://github.com/ajsmit/Quantitative_Ecology/blob/main/_GitBook/LaTeX/The_seaweed_data.pdf</a></p>
<p>I use two data sets. The first, <span class="math inline">\(Y\)</span> (in the file <code>seaweeds.csv</code>), comprises distribution records of 847 macroalgal species within each of 58 × 50 km-long sections of the South African coast (updated from Bolton and Stegenga 2002). This represents <em>ca</em>. 90% of the known seaweed flora of South Africa, but excludes some very small and/or very rare species for which data are insufficient. The data are from verifiable literature sources and John Bolton and Rob Anderson’s own collections, assembled from information collected by teams of phycologists over three decades (Bolton 1986; Stegenga et al. 1997; Bolton and Stegenga 2002; De Clerck et al. 2005). The second, <span class="math inline">\(E\)</span> (in <code>env.csv</code>), is a dataset of <em>in situ</em> coastal seawater temperatures (Smit et al. 2013) derived from daily measurements over up to 40 years.</p>
<div id="setting-up-the-analysis-environment" class="section level2">
<h2>Setting up the analysis environment</h2>
<p>This is <strong>R</strong>, so first I need to find, install and load various packages. Some of the packages will be available on CRAN and can be accessed and installed in the usual way, but others will have to be downloaded from <a href="https://r-forge.r-project.org/R/?group_id=195">R Forge</a>.</p>
<pre class="r"><code>suppressMessages(library(tidyverse))
library(betapart)
suppressMessages(library(vegan))
suppressMessages(library(gridExtra))
suppressMessages(library(BiodiversityR))
library(grid)
library(gridBase)</code></pre>
</div>
<div id="a-look-at-the-data" class="section level2">
<h2>A look at the data</h2>
<p>Let’s load the data and see how it is structured:</p>
<pre class="r"><code>spp &lt;- read.csv(&#39;/Users/ajsmit/Dropbox/R/workshops/Quantitative_Ecology/exercises/diversity/SeaweedsSpp.csv&#39;)
spp &lt;- dplyr::select(spp, -1)

# Lets look at the data:
dim(spp)</code></pre>
<pre><code>## [1]  58 847</code></pre>
<p>We see that our dataset has 58 rows and 847 columns. What is in the columns and rows? Start with the first 5 rows and 5 columns:</p>
<pre class="r"><code>spp[1:5, 1:5]</code></pre>
<pre><code>##   ACECAL ACEMOE ACRVIR AROSP1 ANAWRI
## 1      0      0      0      0      0
## 2      0      0      0      0      0
## 3      0      0      0      0      0
## 4      0      0      0      0      0
## 5      0      0      0      0      0</code></pre>
<p>Now the last 5 rows and 5 columns:</p>
<pre class="r"><code>spp[(nrow(spp) - 5):nrow(spp), (ncol(spp) - 5):ncol(spp)]</code></pre>
<pre><code>##    WOMKWA WOMPAC WRAARG WRAPUR WURMIN ZONSEM
## 53      0      0      1      0      0      0
## 54      0      0      1      0      0      0
## 55      0      0      1      0      0      0
## 56      0      1      1      0      1      0
## 57      1      0      1      0      1      0
## 58      0      0      1      0      1      0</code></pre>
<p>So, each of the rows corresponds to a site (i.e. each of the coastal sections), and the columns each contain a species. The species are arranged alphabetically, and they are indicated by a six-letter code.</p>
</div>
<div id="alpha-diversity" class="section level2">
<h2>Alpha diversity</h2>
<p>We can represent α-diversity in three ways:</p>
<ol style="list-style-type: decimal">
<li><p>as species richness (<em>S</em>),</p></li>
<li><p>as a univariate diversity index, such as Shannon diversity (<em>H’</em>) or Simpson’s diversity (λ), or</p></li>
<li><p>as a dissimilarity index, e.g. Bray-Curtis, Jaccard, or Sørensen dissimilarities—see Koleff (2003) for many more; also see <code>?vegdist</code></p></li>
</ol>
<p>We will work through each in turn.</p>
<div id="species-richness" class="section level3">
<h3>Species richness</h3>
<p>First, species richness. In the seaweed biodiversity data—because we view each coastal section as the local scale (the smallest unit of sampling)—I simply count the number of species within each of the sections. The <code>diversityresult()</code> function in the <strong>BiodiversityR</strong> package does this easily:</p>
<pre class="r"><code>spp_richness &lt;- diversityresult(spp, index = &#39;richness&#39;, method = &#39;each site&#39;)
# spp_richness
ggplot(data = spp_richness, (aes(x = 1:58, y = richness))) +
  geom_line() + xlab(&quot;Coastal section, west to east&quot;) + ylab(&quot;Species richness&quot;)</code></pre>
<p><img src="/collection/quantecol/chapters/02-biodiversity_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>If the <strong>BiodiversityR</strong> package does not work for you, there is also the <code>specnumber()</code> function in <strong>vegan</strong>:</p>
<pre class="r"><code># Use &#39;MARGIN = 1&#39; to calculate the number of species within each row (site)
# specnumber(spp, MARGIN = 1)</code></pre>
<p>In other instances, it makes more sense to calculate the mean species richness of all the sampling units (e.g. quadrats) taken inside the ecosystem of interest. You will have to decide based on your own data.</p>
</div>
<div id="univariate-diversity-indices" class="section level3">
<h3>Univariate diversity indices</h3>
<p>The second way in which we can express α-diversity is to use one of the univariate diversity indices such as Shannon’s <em>H’</em> or Simpson’s λ. Shannon’s <em>H’</em> is sometimes called Shannon’s diversity index, the Shannon–Wiener index, the Shannon–Weaver index, or the Shannon entropy. It is calculated as <span class="math inline">\(H&#39; = -\sum_{i=1}^{R} p_{i} \ln p_{i}\)</span> where <span class="math inline">\(p_{i}\)</span> is the proportion of individuals belonging to the <span class="math inline">\(i\)</span>th species, and <span class="math inline">\(R\)</span> is the species richness.</p>
<p>Simpson’s λ, or simply the Simpson index, is calculated as <span class="math inline">\(\displaystyle \lambda = \sum_{i=1}^{R} p_{i}^{2}\)</span> where <span class="math inline">\(R\)</span> is the species richness and <span class="math inline">\(p_{i}\)</span> is the relative abundance of the <span class="math inline">\(i\)</span>th species.</p>
<p>We cannot calculate either of these for the seaweed data because in order to do so we require abundance data—the seaweed data are presence-absence only. Let’s load a fictitious dataset of the diversity of three different communities of plants, with each community corresponding to a different light environment (dim, mid and high light):</p>
<pre class="r"><code>light &lt;- read.csv(&quot;/Users/ajsmit/Dropbox/R/workshops/Quantitative_Ecology/exercises/diversity/light_levels.csv&quot;)</code></pre>
<pre><code>## Warning in read.table(file = file, header = header, sep = sep, quote = quote, :
## incomplete final line found by readTableHeader on &#39;/Users/ajsmit/Dropbox/R/
## workshops/Quantitative_Ecology/exercises/diversity/light_levels.csv&#39;</code></pre>
<pre class="r"><code>light</code></pre>
<pre><code>##         Site    A    B    C    D    E    F
## 1  low_light 0.75 0.62 0.24 0.33 0.21 0.14
## 2  mid_light 0.38 0.15 0.52 0.57 0.28 0.29
## 3 high_light 0.08 0.15 0.18 0.52 0.54 0.56</code></pre>
<p>We can see above that in stead of having data with 1s and 0s for presence-absence, here we have some values that indicate the relative amounts of each of the species in the three light environments. We calculate species richness (as before), and also the Shannon and Simpson indices using <strong>vegan</strong>’s <code>diversity()</code> function:</p>
<pre class="r"><code>light_div &lt;- data.frame(
  site = c(&quot;low_light&quot;, &quot;mid_light&quot;, &quot;high_light&quot;),
  richness = specnumber(light[, 2:7], MARGIN = 1),
  shannon = round(diversity(light[, 2:7], MARGIN = 1, index = &quot;shannon&quot;), 2),
  simpson = round(diversity(light[, 2:7], MARGIN = 1, index = &quot;simpson&quot;), 2)
)
light_div</code></pre>
<pre><code>##         site richness shannon simpson
## 1  low_light        6    1.62    0.78
## 2  mid_light        6    1.71    0.81
## 3 high_light        6    1.59    0.77</code></pre>
</div>
<div id="dissimilarity-indices" class="section level3">
<h3>Dissimilarity indices</h3>
<p>In this section we will cover the dissimilarity indices, which are special cases of diversity indices that use pairwise comparisons between sampling units, habitats, or ecosystems. Both α- and β-diversity can be expressed as dissimilarity indices, but let deal with α-diversity first.</p>
<p>These dissimilarity indices are multivariate and compare between sites, sections, plots, etc., and must therefore not be confused with the univariate diversity indices.</p>
<p>Recall from the lecture slides the Bray-Curtis and Jaccard dissimilarity indices for abundance data, and the Sørensen dissimilarity index for presence-absence data. The seaweed dataset is a presence-absence dataset, so we will use the Sørensen index. The interpretation of the resulting square (number of rows = number of columns) dissimilarity matrices is the same regardless of whether it is calculated for an abundance dataset or a presence-absence dataset. The values range from 0 to 1, with 0 meaning that the pair of sites being compared is identical (i.e. 0 dissimilarity) and 1 means the pair of sites is completely different (no species in common, hence 1 dissimilarity). In the square dissmilarity matrix the diagonal is 0, which essentially (and obviously) means that any site is identical to itself. Elsewhere the values will range from 0 to 1. Since this is a pairwise calculation (each site compared to every other site), our seaweed dataset will contain (58 × (58 - 1))/2 = 1653 values, each one ranging from 0 to 1.</p>
<p>The first step involves the species table (<span class="math inline">\(Y\)</span>). First we compute the Sørensen dissimilarity index (<span class="math inline">\(\beta_{\text{sør}}\)</span>) to compare the dissimilarity of all pairs of coastal sections using on presence-absence data. The dissimilarity in species composition between two sections is calculated from three parameters, <em>viz</em>., <em>b</em> and <em>c</em>, which represent the number of species unique to each of two sites, and <em>a</em>, the number of species in common between them. It is given by:</p>
<p><span class="math display">\[\beta_\text{sør}=\frac{b+c}{2a+b+c}\]</span></p>
<p>The <strong>vegan</strong> function <code>vegdist()</code> provides access to the dissimilarity indices. We calculate the Sørensen dissimilarity index:</p>
<pre class="r"><code>sor &lt;- vegdist(spp, binary = TRUE) # binary = TRUE sets to presence/absence data
sor_df &lt;- round(as.matrix(sor), 4)
sor_df[1:10, 1:10] # the first 20 rows and columns</code></pre>
<pre><code>##         1      2      3      4      5      6      7      8      9     10
## 1  0.0000 0.0036 0.0036 0.0072 0.0249 0.0391 0.0391 0.0459 0.0592 0.0629
## 2  0.0036 0.0000 0.0000 0.0036 0.0213 0.0355 0.0355 0.0423 0.0556 0.0592
## 3  0.0036 0.0000 0.0000 0.0036 0.0213 0.0355 0.0355 0.0423 0.0556 0.0592
## 4  0.0072 0.0036 0.0036 0.0000 0.0177 0.0318 0.0318 0.0386 0.0519 0.0556
## 5  0.0249 0.0213 0.0213 0.0177 0.0000 0.0140 0.0140 0.0208 0.0342 0.0378
## 6  0.0391 0.0355 0.0355 0.0318 0.0140 0.0000 0.0000 0.0069 0.0205 0.0241
## 7  0.0391 0.0355 0.0355 0.0318 0.0140 0.0000 0.0000 0.0069 0.0205 0.0241
## 8  0.0459 0.0423 0.0423 0.0386 0.0208 0.0069 0.0069 0.0000 0.0136 0.0171
## 9  0.0592 0.0556 0.0556 0.0519 0.0342 0.0205 0.0205 0.0136 0.0000 0.0034
## 10 0.0629 0.0592 0.0592 0.0556 0.0378 0.0241 0.0241 0.0171 0.0034 0.0000</code></pre>
<p>What we see above is a square dissimilarity matrix. The two most important characteristics of the matrix are:</p>
<ol style="list-style-type: lower-roman">
<li><p>Whereas the raw species data (<span class="math inline">\(Y\)</span>) is rectangular (number rows ≠ number columns), the dissimilarity matrix is square (number rows = number columns).</p></li>
<li><p>The diagonal is filled with 0.</p></li>
<li><p>The matrix is symetrical—it is comprised of symetrical upper and lower triangles.</p></li>
</ol>
</div>
<div id="questions-a" class="section level3">
<h3>Questions (A)</h3>
<blockquote>
<p><strong>Question 1:</strong> Why is the matrix square, and what determines the number of rows/columns?</p>
</blockquote>
<blockquote>
<p><strong>Question 2:</strong> What is the meaning of the diagonal?</p>
</blockquote>
<blockquote>
<p><strong>Question 3:</strong> What is the meaning of the non-diagonal elements?</p>
</blockquote>
<blockquote>
<p><strong>Question 4:</strong> Take the data in row 1 and create a line graph that shows these values as a function of section number.</p>
</blockquote>
<blockquote>
<p><strong>Question 5:</strong> Provide a mechanistic (ecological) explanation for why this figure takes the shape that it does.</p>
</blockquote>
<p><span style="color:red">Submit an R script wherein you provide answers to these questions by no later than 17:00 on Wednesday 30 June 2021.</span></p>
</div>
</div>
<div id="gamma-diversity" class="section level2">
<h2>Gamma diversity</h2>
<p>Returning again to the seaweed data, <span class="math inline">\(Y\)</span>, lets now look at λ-diversity—this would simply be the total number of species along the South African coastline in all 58 coastal sections. Since each column represents one species, and the dataset contains data collected at each of the 58 sites (the number of rows), we can simply do:</p>
<pre class="r"><code># the number of columns gives the total number of species in this example:
ncol(spp)</code></pre>
<pre><code>## [1] 847</code></pre>
<p>We can also use:</p>
<pre class="r"><code>diversityresult(spp, index = &#39;richness&#39;, method = &#39;pooled&#39;)</code></pre>
<pre><code>##        richness
## pooled      846</code></pre>
<div id="questions-b" class="section level3">
<h3>Questions (B)</h3>
<blockquote>
<p><strong>Question 6:</strong> Why is there a difference between the two?</p>
</blockquote>
<blockquote>
<p><strong>Question 7:</strong> Which is correct?</p>
</blockquote>
<p><span style="color:red">Submit an R script wherein you provide answers to these questions by no later than 17:00 on Wednesday 30 June 2021.</span></p>
<p>Think before you calculate γ-diversity for your own data as it might not be as simple as here!</p>
</div>
</div>
<div id="whittakers-concept-of-β-diversity" class="section level2">
<h2>Whittaker’s concept of β-diversity</h2>
<p>The first measure of β-diversity comes from Whittaker (1960) and is called <em>true β-diversity</em>. This is simply dividing the γ-diversity for the region by the α-diversity for a specific coastal section. We can calculate it all at once for the whole dataset and make a graph:</p>
<pre class="r"><code>true_beta &lt;- data.frame(
  beta = specnumber(spp, MARGIN = 1) / ncol(spp),
  section_no = c(1:58)
)
# true_beta
ggplot(data = true_beta, (aes(x = section_no, y = beta))) +
  geom_line() + xlab(&quot;Coastal section, west to east&quot;) + ylab(&quot;True beta-diversity&quot;)</code></pre>
<p><img src="/collection/quantecol/chapters/02-biodiversity_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>The second measure of β-diversity is <em>absolute species turnover</em>, and to calculate this we simply simply substract α-diversity for each section from the region’s γ-diversity:</p>
<pre class="r"><code>abs_beta &lt;- data.frame(
  beta = ncol(spp) - specnumber(spp, MARGIN = 1),
  section_no = c(1:58)
)
# abs_beta
ggplot(data = abs_beta, (aes(x = section_no, y = beta))) +
  geom_line() + xlab(&quot;Coastal section, west to east&quot;) + ylab(&quot;Absolute beta-diversity&quot;)</code></pre>
<p><img src="/collection/quantecol/chapters/02-biodiversity_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="contemporary-definitions-β-diversity" class="section level2">
<h2>Contemporary definitions β-diversity</h2>
<p>β-diversity is a concept that describes how species assemblages (communities) measured within the ecosystem of interest vary from place to place, e.g. between the various transects or quadrats used to sample the ecosystem. β-diversity results from habitat heterogeneity (along gradients, or randomly). We have already seen two concepts of β-diversity, viz. true β-diversity and absolute species turnover—both of these rely on knowledge of species richness at local (a measure of α-diversity) and regional (γ-diversity) scales. Much more insight into species assembly processes can be extracted, however, when we view β-diversity as a dissmilarity index. In this view, we will see that there are two processes by which β-diversity might be affected (i.e. in which the patterning of communities over landscapes might arise):</p>
<p><strong>Process 1:</strong> If a region is comprised of the species A, B, C, …, M (i.e. γ-diversity is 13), a subset of the regional flora as captured by one quadrat might be species <strong>A</strong>, <strong>D</strong>, E, whereas in another quadrat it might be species <strong>A</strong>, <strong>D</strong>, F. In this instance, the α-diversity is 3 in both instances, and heterogeneity (and hence β-diversity) results from the fact that the first quadrat has species E but the other has species F. In other words, here we have the same number of species in both quadrats, but only two of the species are the same. The process responsible for this form of β-diversity is species ‘turnover’ (<span class="math inline">\(\beta_\text{sim}\)</span>). Turnover refers to processes that cause communities to differ due to species being lost and/or gained from section to section, i.e. the species composition changes between sections without corresponding changes in α-diversity.</p>
<p><strong>Process 2:</strong> Consider again species A, B, C, …, M. Now we have the first quadrat with species <strong>A</strong>, <strong>B</strong>, C, D, <strong>G</strong>, H (α-diversity is 6) and the second quadrat has a subset of this, e.g. only species <strong>A</strong>, <strong>B</strong>, <strong>G</strong> (α-diversity 3). Here, β-diversity comes from the fact that even if the two places share the same species, the number of species can still differ amongst the quadrats (i.e. from place to place) due to one quadrat capturing only a subset of species present in the other. This form of β-diversity is called ‘nestedness-resultant’ β-diversity (<span class="math inline">\(\beta_\text{sne}\)</span>), and it refers to processes that cause species to be gained or lost, and the community with the lowest α-diversity is a subset of the richer community.</p>
<p>The above two examples show that β-diversity is coupled not only with the identity of the species in the quadrats, but also α-diversity—with species richness in particular.</p>
<p>We express β-diversity as ‘nestedness-resultant’ (<span class="math inline">\(\beta_\text{sne}\)</span>) and ‘turnover’ (<span class="math inline">\(\beta_\text{sim}\)</span>) components so as to be able to distinguish between these two processes. It allows us to make inferences about the two possible drivers of β-diversity. Turnover refers to processes that cause communities to differ due to species being lost and/or gained from section to section, i.e. the species composition changes between sections without corresponding changes in α-diversity. The nestedness-resultant component implies processes that cause species to be gained or lost without replacement, and the community with the lowest α-diversity is a subset of the richer community.</p>
<p>How do we calculate the turnover and nestedness-resultant components of β-diversity? The <strong>betapart</strong> package (Baselga et al. 2017) comes to the rescue. We decompose the dissimilarity into the <span class="math inline">\(\beta_\text{sim}\)</span> and <span class="math inline">\(\beta_\text{sne}\)</span> components (Baselga 2010) using the <code>betapart.core()</code> and <code>betapart.pair()</code> functions. The outcomes of this partitioning calculation are placed into the matrices <span class="math inline">\(Y1\)</span> and <span class="math inline">\(Y2\)</span>. These data can then be analysed further—e.g. we can apply a principal components analysis (PCA) or another multivariate analysis on <span class="math inline">\(Y\)</span> to find the major patterns in the community data—we will do this in a later section.</p>
<pre class="r"><code># Decompose total Sørensen dissimilarity into turnover and nestedness-resultant components:
Y.core &lt;- betapart.core(spp)
Y.pair &lt;- beta.pair(Y.core, index.family = &quot;sor&quot;)

# Let Y1 be the turnover component (beta-sim):
Y1 &lt;- as.matrix(Y.pair$beta.sim)

# Let Y2 be the nestedness-resultant component (beta-sne):
Y2 &lt;- as.matrix(Y.pair$beta.sne)</code></pre>
<pre class="r"><code>round(Y1[1:10, 1:10], 4)</code></pre>
<pre><code>##         1      2      3      4      5      6      7      8      9     10
## 1  0.0000 0.0000 0.0000 0.0000 0.0072 0.0217 0.0217 0.0217 0.0217 0.0290
## 2  0.0000 0.0000 0.0000 0.0000 0.0072 0.0216 0.0216 0.0216 0.0216 0.0288
## 3  0.0000 0.0000 0.0000 0.0000 0.0072 0.0216 0.0216 0.0216 0.0216 0.0288
## 4  0.0000 0.0000 0.0000 0.0000 0.0071 0.0214 0.0214 0.0214 0.0214 0.0286
## 5  0.0072 0.0072 0.0072 0.0071 0.0000 0.0140 0.0140 0.0140 0.0140 0.0210
## 6  0.0217 0.0216 0.0216 0.0214 0.0140 0.0000 0.0000 0.0000 0.0000 0.0070
## 7  0.0217 0.0216 0.0216 0.0214 0.0140 0.0000 0.0000 0.0000 0.0000 0.0070
## 8  0.0217 0.0216 0.0216 0.0214 0.0140 0.0000 0.0000 0.0000 0.0000 0.0069
## 9  0.0217 0.0216 0.0216 0.0214 0.0140 0.0000 0.0000 0.0000 0.0000 0.0000
## 10 0.0290 0.0288 0.0288 0.0286 0.0210 0.0070 0.0070 0.0069 0.0000 0.0000</code></pre>
<pre class="r"><code>round(Y2[1:10, 1:10], 4)</code></pre>
<pre><code>##         1      2      3      4      5      6      7      8      9     10
## 1  0.0000 0.0036 0.0036 0.0072 0.0177 0.0174 0.0174 0.0242 0.0375 0.0340
## 2  0.0036 0.0000 0.0000 0.0036 0.0141 0.0139 0.0139 0.0207 0.0340 0.0305
## 3  0.0036 0.0000 0.0000 0.0036 0.0141 0.0139 0.0139 0.0207 0.0340 0.0305
## 4  0.0072 0.0036 0.0036 0.0000 0.0105 0.0104 0.0104 0.0172 0.0305 0.0270
## 5  0.0177 0.0141 0.0141 0.0105 0.0000 0.0000 0.0000 0.0068 0.0203 0.0168
## 6  0.0174 0.0139 0.0139 0.0104 0.0000 0.0000 0.0000 0.0069 0.0205 0.0171
## 7  0.0174 0.0139 0.0139 0.0104 0.0000 0.0000 0.0000 0.0069 0.0205 0.0171
## 8  0.0242 0.0207 0.0207 0.0172 0.0068 0.0069 0.0069 0.0000 0.0136 0.0102
## 9  0.0375 0.0340 0.0340 0.0305 0.0203 0.0205 0.0205 0.0136 0.0000 0.0034
## 10 0.0340 0.0305 0.0305 0.0270 0.0168 0.0171 0.0171 0.0102 0.0034 0.0000</code></pre>
<div id="questions-c" class="section level3">
<h3>Questions (C)</h3>
<blockquote>
<p><strong>Question 8:</strong> Plot species turnover as a function of Section number, and provide a mechanistic exaplanation for the pattern observed.</p>
</blockquote>
<blockquote>
<p><strong>Question 9:</strong> Based on an assessment of literature on the topic, provide a discussion of nestedness-resultant β-diversity. Use either a marine or terrestrial example to explain this mode of structuring biodiversity.</p>
</blockquote>
<p><span style="color:red">Submit an R script wherein you provide answers to these questions by no later than 17:00 on Friday 2 July 2021.</span></p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Baselga, A. (2010). Partitioning the turnover and nestedness components of beta diversity. Global Ecology and Biogeography 19, 134–143.</p>
<p>Baselga, A., Orme, D., Villeger, S., De Bortoli, J., and Leprieur, F. (2017). betapart: Partitioning Beta Diversity into Turnover and Nestedness Components. R package version 1.4-1.</p>
<p>Bolton, J. J. (1986). Marine phytogeography of the Benguela upwelling region on the west coast of southern Africa: A temperature dependent approach. Botanica Marina 29, 251–256.</p>
<p>Bolton, J. J., and Stegenga, H. (2002). Seaweed species diversity in South Africa. South African Journal of Marine Science 24, 9–18.</p>
<p>De Clerck, O., Bolton, J. J., Anderson, R. J., and Coppejans, E. (2005). Guide to the seaweeds of KwaZulu- Natal. Scripta Botanica Belgica 33, 294 pp.</p>
<p>Koleff, P., Gaston, K. J., &amp; Lennon, J. J. (2003). Measuring beta diversity for presence–absence data. Journal of Animal Ecology, 72(3), 367-382.</p>
<p>Smit, A. J., Bolton, J. J., &amp; Anderson, R. J. (2017). Seaweeds in two oceans: beta-diversity. Frontiers in Marine Science, 4, 404.</p>
<p>Smit, A. J., Roberts, M., Anderson, R. J., Dufois, F., Dudley, S. F. J., Bornman, T. G., et al. (2013). A coastal seawater temperature dataset for biogeographical studies: large biases between in situ and remotely-sensed data sets around the coast of South Africa. PLOS ONE 8, e81944.</p>
<p>Stegenga, H., Bolton, J. J., and Anderson, R. J. (1997). Seaweeds of the South African west coast. Contribu- tions of the Bolus Herbarium 18, 3–637.</p>
<p>Whittaker, R. H. (1960). Vegetation of the Siskiyou Mountains, Oregon and California. Ecological Monographs. 30 (3): 279–338.</p>
</div>
</div>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
    <a class="prev dtc pr2 tl v-top fw6"
    href="/workshops/quantecol/chapters/01-data/">&larr; 1. Multivariate data</a>
  
  
  
    <a class="next dtc pl2 tr v-top fw6"
    href="/workshops/quantecol/chapters/03-deep_dive/">3. Deep Dive into Gradients &rarr;</a>
  
</div>

      </footer>
    </article>
    
      
<div class="post-comments pa0 pa4-l mt4">
  
  <script src="https://utteranc.es/client.js"
          repo="robwschlegel/heatwaveR"
          issue-term="pathname"
          theme="boxy-light"
          label="comments :crystal_ball:"
          crossorigin="anonymous"
          async
          type="text/javascript">
  </script>
  
</div>

    
  </section>
</main>

<aside class="page-sidebar" role="complementary">
                         
 











  <img src="/workshops/featured-sidebar.jpg" class="db ma0">

                         
 



<div class="flex items-start sticky ph4 pb4 flex-row">
  <div class="w-two-thirds w-50-l ph0">
    <h2 class="mv3 f5 fw7 ttu tracked">
      <a class="no-underline dim" href="/workshops/">Outline</a></h2>
    <nav id="SectionTableOfContents" aria-label="SectionTableOfContents">
        <ul>
        
          
          
          
          <details  class="">
            <summary class="" hugo-nav="/workshops/intro_r/"><a href="/workshops/intro_r/">BCB744 (Intro R)</a></summary>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/02-rstudio/"><a href="/workshops/intro_r/chapters/02-rstudio/">1. RStudio and R</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/03-github/"><a href="/workshops/intro_r/chapters/03-github/">2. GitHub</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/04-workflow/"><a href="/workshops/intro_r/chapters/04-workflow/">3. An R workflow</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/05-graphics/"><a href="/workshops/intro_r/chapters/05-graphics/">4. Graphics with ggplot2</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/06-faceting/"><a href="/workshops/intro_r/chapters/06-faceting/">5. Faceting figures</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/07-brewing/"><a href="/workshops/intro_r/chapters/07-brewing/">6. Brewing colours</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/08-mapping/"><a href="/workshops/intro_r/chapters/08-mapping/">7. Mapping with ggplot2</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/09-mapping_style/"><a href="/workshops/intro_r/chapters/09-mapping_style/">8. Mapping with style</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/10-mapping_openstreetmap/"><a href="/workshops/intro_r/chapters/10-mapping_openstreetmap/">9. Mapping with OpenStreetMap</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/11-tidy/"><a href="/workshops/intro_r/chapters/11-tidy/">10. Tidy data</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/12-tidier/"><a href="/workshops/intro_r/chapters/12-tidier/">11. Tidier data</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/13-tidiest/"><a href="/workshops/intro_r/chapters/13-tidiest/">12. Tidiest data</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/14-recap/"><a href="/workshops/intro_r/chapters/14-recap/">13. Recap</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/15-functions/"><a href="/workshops/intro_r/chapters/15-functions/">14. Functions by chapter</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/16-base_r/"><a href="/workshops/intro_r/chapters/16-base_r/">15. Base R primer</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/17-dates/"><a href="/workshops/intro_r/chapters/17-dates/">16. Dates</a></li>
            
          </details>
          
          </li>
        
          
          
          
          <details  class="">
            <summary class="" hugo-nav="/workshops/biostats/"><a href="/workshops/biostats/">BCB744 (Biostats)</a></summary>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/02-data/"><a href="/workshops/biostats/chapters/02-data/">1. Types of data</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/03-descriptive/"><a href="/workshops/biostats/chapters/03-descriptive/">2. Central tendency and dispersion</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/04-graphics/"><a href="/workshops/biostats/chapters/04-graphics/">3. Graphical data displays</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/06-t_tests/"><a href="/workshops/biostats/chapters/06-t_tests/">5. Inferences about one or two populations</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/07-anova/"><a href="/workshops/biostats/chapters/07-anova/">6. Analysis of Variance (ANOVA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/08-regressions/"><a href="/workshops/biostats/chapters/08-regressions/">7. Simple linear regressions</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/09-correlations/"><a href="/workshops/biostats/chapters/09-correlations/">8. Correlation</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/10-confidence/"><a href="/workshops/biostats/chapters/10-confidence/">9. Confidence intervals</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/11-transformations/"><a href="/workshops/biostats/chapters/11-transformations/">10. Data transformations</a></li>
            
          </details>
          
          </li>
        
          
          
          
          <details open class="active">
            <summary class="active" hugo-nav="/workshops/quantecol/"><a href="/workshops/quantecol/">BCB743</a></summary>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/01-data/"><a href="/workshops/quantecol/chapters/01-data/">1. Multivariate data</a></li>
            
              
              <li class="active" hugo-nav="/workshops/quantecol/chapters/02-biodiversity/"><a href="/workshops/quantecol/chapters/02-biodiversity/">2. Biodiversity</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/03-deep_dive/"><a href="/workshops/quantecol/chapters/03-deep_dive/">3. Deep Dive into Gradients</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/04-env_dist/"><a href="/workshops/quantecol/chapters/04-env_dist/">4. Environmental Distance</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/05-spp_dissimilarity/"><a href="/workshops/quantecol/chapters/05-spp_dissimilarity/">5. Species Dissimilarities</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/06-correlations/"><a href="/workshops/quantecol/chapters/06-correlations/">6. Correlations and Associations</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/08_pca/"><a href="/workshops/quantecol/chapters/08_pca/">8a. Principal Component Analysis (PCA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/08-pca_sdg/"><a href="/workshops/quantecol/chapters/08-pca_sdg/">8b. PCA of WHO SDGs</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/09-ca/"><a href="/workshops/quantecol/chapters/09-ca/">9. Correspondence Analysis (CA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/10-pcoa/"><a href="/workshops/quantecol/chapters/10-pcoa/">10. Principal Coordinate Analysis (PCoA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/11-nmds/"><a href="/workshops/quantecol/chapters/11-nmds/">11a. non-Metric multidimensional scaling (nMDS)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/11-nmds_diatoms/"><a href="/workshops/quantecol/chapters/11-nmds_diatoms/">11b. nMDS of Mayombo&#39;s diatom data</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/12-constrained_ordination/"><a href="/workshops/quantecol/chapters/12-constrained_ordination/">12. Constrained Ordination</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/13-cluster_analysis/"><a href="/workshops/quantecol/chapters/13-cluster_analysis/">13. Cluster analysis</a></li>
            
          </details>
          
          </li>
        
        </ul>
    </nav>
  </div>
  <details id="PageTableOfContents">
    <summary><h2 class="mv0 f5 fw7 ttu tracked dib">On this page<h2></summary>
    <div class="pl2 pr0 mh0">
    
    </div>
  </details>
  
</div>

</aside>

<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2022 University of the Western Cape, Cape Town
      <span class="middot-divider"></span>
      Made with <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo Apéro</a></span>.
      <br />
      
Based on <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0">
      <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/ajsmit/" title="github" target="_blank" rel="noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="http://orcid.org/0000-0002-3799-6126" title="orcid" target="_blank" rel="noopener">
      <i class="ai ai-orcid fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.researchgate.net/profile/Albertus-Smit" title="researchgate" target="_blank" rel="noopener">
      <i class="ai ai-researchgate fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://uwc.academia.edu/AlbertusSmit" title="academia" target="_blank" rel="noopener">
      <i class="ai ai-academia fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://scholar.google.co.za/citations?user=ATsBBKoAAAAJ&amp;hl=en" title="google-scholar" target="_blank" rel="noopener">
      <i class="ai ai-google-scholar fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.instagram.com/ajsmit/" title="instagram" target="_blank" rel="noopener">
      <i class="fab fa-instagram fa-lg fa-fw"></i>
    </a>
  
</div>

    </div>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
      <a class="dib pv1 ph2 link" href="/license/" title="License">License</a>
      
      <a class="dib pv1 ph2 link" href="/contact/" title="Contact form">Contact</a>
      
      <a class="dib pv1 ph2 link" href="/contributors/" title="Contributors">Contributors</a>
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>
