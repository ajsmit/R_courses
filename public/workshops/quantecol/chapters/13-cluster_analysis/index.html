<!DOCTYPE html>
<html lang="en" dir="ltr"><head>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.96.0" />
<title>13. Cluster analysis | BCB R Stats Pages</title>


<meta property="twitter:site" content="@ajsmit">
<meta property="twitter:creator" content="@ajsmit">







  
    
  
<meta name="description" content="What you need to know upfront.">


<meta property="og:site_name" content="BCB R Stats Pages">
<meta property="og:title" content="13. Cluster analysis | BCB R Stats Pages">
<meta property="og:description" content="What you need to know upfront." />
<meta property="og:type" content="page" />
<meta property="og:url" content="/workshops/quantecol/chapters/13-cluster_analysis/" />
<meta property="og:locale" content="en">




    
        <meta property="og:image" content="/img/papillons.jpg" >
        <meta property="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="/img/papillons.jpg" >
    
  <meta itemprop="name" content="13. Cluster analysis">
<meta itemprop="description" content="“There are two types of people in the world: 1) those who extrapolate from incomplete data.” – Anon.
 We have seen that the WHO/SDG data seem to form neat groupings of countries within their respective parent locations. In this exercise we will apply a cluster analysis called ‘Partitioning Around Medoids’ to these data. Whereas ordination attempts to display the presence and influence of gradients, clustering tries to place our samples into a certain number of discrete units or clusters."><meta itemprop="datePublished" content="2021-01-01T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-01-01T00:00:00+00:00" />
<meta itemprop="wordCount" content="1932">
<meta itemprop="keywords" content="" />
  
  
  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.13dd27d3efb7ed4ad82be3040182ddbf5ab9d3b4d6d01f0ba3930845932fce66.css" integrity="sha256-E90n0&#43;&#43;37UrYK&#43;MEAYLdv1q507TW0B8Lo5MIRZMvzmY=" media="screen">
  
  
  <script src="/panelset.min.8f4cba0107356728f266d94a12a4d18ef504eda8a9a284cda73675bae7884a68.js" type="text/javascript"></script>
  
  
  <script src="/main.min.318ee9c0652bba0149e7503c97e37e638937f3a9cad9233e6d0ba00bf7a46a5e.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container single-series">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="/" title="Home">
      <img src="/img/xaringan-outline.png" class="dib db-l h2 w-auto" alt="BCB R Stats Pages">
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="About AJ Smit">About</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/workshops/" title="BCB Hons">BCB Hons</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/project/" title="Project Portfolio">Projects</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/collection/" title="R Courses">R Courses</a>
      
      
    </div>
  </nav>
</header>


<main class="page-main ph4 pt4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 pr3-l">
      <header class="post-header">
        <h4 class="breadcrumb pb5">

  
    
      
  
    
      
  
    
      
  

    
    
      <a href="/workshops/">B.Sc. (Hons.) R modules</a>
    
  

    
    
      <a href="/workshops/quantecol/">BCB743</a>
    
  

    
    
      13. Cluster analysis
    
  

</h4>




        
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">13. Cluster analysis</h1>
        
        <p class="f6 measure lh-copy mv1"></p>
        <p class="f7 db mv0 ttu">January 1, 2021</p>
        
        
      
        
      </header>
      <section class="post-body pt5 pb4">
        


<!-- # Topic 13: Cluster analysis -->
<blockquote>
<p>“There are two types of people in the world: 1) those who extrapolate from incomplete data.” – Anon.</p>
</blockquote>
<p>We have seen that the WHO/SDG data seem to form neat groupings of countries within their respective parent locations. In this exercise we will apply a cluster analysis called ‘Partitioning Around Medoids’ to these data. Whereas ordination attempts to display the presence and influence of gradients, clustering tries to place our samples into a certain number of discrete units or clusters. The goal of the clustering algorithms is to produce groups (clusters) such that dissimilarites between objects within these groups are smaller than those between them.</p>
<p>My reading of the ecological literature suggests that cluster analysis is far less common than ordination, unless you’re an ecologist with conservationist tendencies. If this is a true observation, why would it be? This is also the reason why I spend less time in this module on cluster analysis, but it is nevertheless a tool that you should be familiar with. Sometimes clustering techniques are combined with ordinations (particularly PCA), in which case they can be quite powerful and insightful.</p>
<p>Broadly speaking, clustering algorithms can be devided into <a href="https://www.davidzeleny.net/anadat-r/doku.php/en:hier-agglom_r">‘hierarchical agglomerative classification’</a> and <a href="https://www.davidzeleny.net/anadat-r/doku.php/en:non-hier_r">non-hierarchical classification (e.g. K-means)</a>. Numerical Ecology in R provides more information about the various kinds of classifications and makes the following distinctions of classification methods: ‘sequential or simultaneous,’ ‘agglomerative or divisive,’ ‘monothetic versus polythetic,’ ‘hierarchical versus non-hierarchical methods,’ ‘probabilistic versus non-probabilistic,’ and ‘fuzzy’ methods. Regardless of how one classifies the classification alogrithms, they are well-represented in R. The workhorse cluster analysis package in R is, strangely, called <strong>cluster</strong>. The function we will use in this example is called <code>pam()</code> but several other functions are also available, most notably ‘Agglomerative Nesting (Hierarchical Clustering)’ called by <code>agnes()</code>, ‘DIvisive ANAlysis Clustering’ by <code>diana()</code>, and ‘Fuzzy Analysis Clustering’ by <code>fanny()</code>. The <code>kmeans()</code> and <code>hclust()</code> functions in base R are also available and frequently used by ecologists. Of course, there is also the old faithful <a href="https://github.com/jarioksa/twinspan">TWINSPAN</a> which has been ported to R that might be of interest still, and <a href="https://doi.org/10.1016/B978-0-12-384719-5.00430-5">IndVal</a>, which is a modern replacement for TWINSPAN. All of the cluster analyses functions come with their own plotting methods, and you should become familiar with them.</p>
<p>The package <strong>factoextra</strong> provides useful helper functions for cluster analysis, and also provides clustering functions that can be used <em>in lieu</em> of the ones mentioned above.</p>
<p>For examples of clustering, please refer to:</p>
<ol style="list-style-type: decimal">
<li>Numerical Ecology in R, pp. 53-62. Later pages in the Cluster Analysis chapter go deeper into clustering and you should read over it for a broad overview. For the purpose of this module, we will focus on 4.3 Hierarchical Clustering and 4.4 Agglomerative Clustering.</li>
<li>A <a href="https://www.kaggle.com/davimattar/help-international-clustering-using-r">Kaggle challenge</a> with examples of both Hierarchical Clustering and K-means Clustering.</li>
<li>The <code>iris</code> dataset is an excellent dataset to practice cluster analysis on; in fact, cluster analysis examples of this dataset are common on the internet.</li>
</ol>
<p>Let’s explore the WHO/SDG dataset usig the <code>pam()</code> function.</p>
<div id="set-up-the-analysis-environment" class="section level2">
<h2>Set-up the analysis environment</h2>
<pre class="r"><code>library(tidyverse) 
library(cluster)
library(ggcorrplot)
library(factoextra)
library(vegan)
library(ggpubr)</code></pre>
</div>
<div id="load-the-sdg-data" class="section level2">
<h2>Load the SDG data</h2>
<p>I load the combined dataset that already had their missing values imputed (as per the <a href="https://github.com/ajsmit/Quantitative_Ecology/blob/main/jupyter_lab/Topic_8-PCA-SDG-example.ipynb">PCA</a> example).</p>
<pre class="r"><code>SDGs &lt;- read_csv(&quot;/Users/ajsmit/Dropbox/R/workshops/Quantitative_Ecology/exercises/WHO/SDG_complete.csv&quot;)</code></pre>
<pre><code>## Rows: 176 Columns: 40
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (2): ParentLocation, Location
## dbl (38): other_1, other_2, SDG1.a, SDG16.1, SDG3.1_1, SDG3.2_1, SDG3.2_2, S...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>SDGs[1:5, 1:8]</code></pre>
<pre><code>## # A tibble: 5 × 8
##   ParentLocation       Location other_1 other_2 SDG1.a SDG16.1 SDG3.1_1 SDG3.2_1
##   &lt;chr&gt;                &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 Eastern Mediterrane… Afghani…    61.6    15.6   2.14    9.02      673   135.  
## 2 Europe               Albania     77.8    21.1   9.62    3.78       16     7.55
## 3 Africa               Algeria     76.5    21.8  10.7     1.66      113    38.0 
## 4 Africa               Angola      61.7    16.7   5.43    9.82      246   125.  
## 5 Americas             Antigua…    76.1    20.4  11.6     2.42       43     5.94</code></pre>
<p>The parent locations:</p>
<pre class="r"><code>unique(SDGs$ParentLocation)</code></pre>
<pre><code>## [1] &quot;Eastern Mediterranean&quot; &quot;Europe&quot;                &quot;Africa&quot;               
## [4] &quot;Americas&quot;              &quot;Western Pacific&quot;       &quot;South-East Asia&quot;</code></pre>
<p>The number of countries:</p>
<pre class="r"><code>length(SDGs$Location)</code></pre>
<pre><code>## [1] 176</code></pre>
<p>As is often the case with measured variables, we can start our exploration with a correlation analysis to see the extent to which correlation between variable pairs is present:</p>
<pre class="r"><code># a correalation matrix
corr &lt;- round(cor(SDGs[3:ncol(SDGs)]), 1)
ggcorrplot(corr, type = &#39;upper&#39;, outline.col = &quot;white&quot;, 
          colors = c(&quot;navy&quot;, &quot;white&quot;, &quot;#FC4E07&quot;), 
          lab = TRUE)</code></pre>
<p><img src="/collection/quantecol/chapters/13-cluster_analysis_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>We might decide to remove collinear variables. A useful approach to use here might be to look at the strongest loadings along the significant reduced axes in a PCA and exclude the others, or find the ones most strongly correlated as seen in the biplots—how you do this can be rationalised on a case-by-case basis. I proceed with the full dataset, but this is not ideal.</p>
<p>We need to standardise first to account for the different measurement scales of the variables. We can calculate Euclidian distances before running <code>pam()</code>, but it can also be specified within the function call. We do the latter:</p>
<pre class="r"><code>SDGs_std &lt;- decostand(SDGs[3:ncol(SDGs)], method = &quot;standardize&quot;)
# SDGs_euc &lt;- vegdist(SDGs_std, method = &quot;euclidian&quot;)
rownames(SDGs_std) &lt;- SDGs$Location # carry location names into output</code></pre>
<p>The frustrating thing with cluster analysis, which often confuses novice users, is that there is often an expectation that the clustering alorithm decides for the user how many clusters to use. However, this is a misconception that must be overcome. Although some numerical guidance can be obtained through ‘silhouette,’ ‘within cluster sum of squares’ or ‘elbow’ analysis, and ‘gap statistic’, in my experience they are no substitute for the power of human reasoning. Let us see what the <strong>factoextra</strong> package function <code>fviz_nbclust()</code> tell us about how many group to use:</p>
<pre class="r"><code># using silhouette analysis
plt1 &lt;- fviz_nbclust(SDGs_std, cluster::pam, method = &quot;silhouette&quot;) + theme_grey()

# total within cluster sum of square / elbow analysis
plt2 &lt;- fviz_nbclust(SDGs_std, cluster::pam, method = &quot;wss&quot;) + theme_grey()

# gap statistics
plt3 &lt;- fviz_nbclust(SDGs_std, cluster::pam, method = &quot;gap_stat&quot;) + theme_grey()

ggarrange(plt1, plt2, plt3, nrow = 3)</code></pre>
<p><img src="/collection/quantecol/chapters/13-cluster_analysis_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Even with the supposedly objective assessment of what the optimal number of clusters should be, we see that each method still provides a different result. Much better to proceed with expert knowledge about the nature of the data and the intent of the study. Let us proceed with three clusters as I think two clusters are insufficient for our purpose.</p>
<pre class="r"><code>SDGs_pam &lt;- pam(SDGs_std, metric = &quot;euclidean&quot;, k = 3)

fviz_cluster(SDGs_pam, geom = &quot;point&quot;, ellipse.type = &quot;convex&quot;, palette = c(&quot;#FC4E07&quot;, &quot;violetred3&quot;, &quot;deepskyblue3&quot;), ellipse.alpha = 0.05) +
  geom_text(aes(label = SDGs$Location), size = 2.5)</code></pre>
<p><img src="/collection/quantecol/chapters/13-cluster_analysis_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>We cannot clearly see where SA is, so let’s create a clearer plot:</p>
<pre class="r"><code># scale SA bigger for plotting
SDGs &lt;- SDGs |&gt; 
  mutate(col_vec = ifelse(Location == &quot;South Africa&quot;, &quot;black&quot;, &quot;grey50&quot;),
         scale_vec = ifelse(Location == &quot;South Africa&quot;, 3.5, 2.5))

fviz_cluster(SDGs_pam, geom = &quot;point&quot;, ellipse.type = &quot;convex&quot;,
             palette = c(&quot;#FC4E07&quot;, &quot;violetred3&quot;, &quot;deepskyblue3&quot;),
             ellipse.alpha = 0.05, pointsize = 2.0) +
  geom_text(aes(label = SDGs$Location), size = SDGs$scale_vec, col = SDGs$col_vec)</code></pre>
<p><img src="/collection/quantecol/chapters/13-cluster_analysis_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Note that <code>pam()</code>, unlike hierarchical or agglomerative clustering, does not produce a dendrogram and the usual way to graphically present the cluster arrangement is to create a scatter plot similar to an ordination diagramme (but it is NOT an ordination diagram).</p>
<p>Same as above, but showing a star plot and numbers indicating the countries (their row numbers in <code>SDGs</code>):</p>
<pre class="r"><code>fviz_cluster(SDGs_pam, palette = c(&quot;#FC4E07&quot;, &quot;violetred3&quot;, &quot;deepskyblue3&quot;), ellipse.type = &quot;euclid&quot;, 
             star.plot = TRUE, repel = TRUE, pointsize = SDGs$scale_vec * 0.8) + # SA, no 147, plotted slightly bigger
  theme_grey()</code></pre>
<pre><code>## Warning: ggrepel: 153 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="/collection/quantecol/chapters/13-cluster_analysis_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Do a silhouette analysis to check cluster fidelity:</p>
<pre class="r"><code>fviz_silhouette(SDGs_pam, palette = c(&quot;#FC4E07&quot;, &quot;violetred3&quot;, &quot;deepskyblue3&quot;), ggtheme = theme_grey())</code></pre>
<pre><code>##   cluster size ave.sil.width
## 1       1   46          0.27
## 2       2   78          0.09
## 3       3   52          0.27</code></pre>
<p><img src="/collection/quantecol/chapters/13-cluster_analysis_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Once happy with the number of clusters, find the median value for each cluster:</p>
<pre class="r"><code>SDGs_centroids &lt;- SDGs |&gt; 
  mutate(cluster = SDGs_pam$clustering) |&gt; 
  group_by(cluster) |&gt; 
  summarise_at(vars(other_1:SDG3.b_5), median, na.rm = TRUE)
SDGs_centroids</code></pre>
<pre><code>## # A tibble: 3 × 39
##   cluster other_1 other_2 SDG1.a SDG16.1 SDG3.1_1 SDG3.2_1 SDG3.2_2 SDG3.2_3
##     &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1       1    62.4    16.7   5.43    8.88      396    90.0    214.     152.  
## 2       2    73.2    19.6   9.64    4.4        60    19.8     33.9     28.1 
## 3       3    80.4    23.2  13.3     1.28        7     2.78     4.73     4.00
## # … with 30 more variables: SDG3.3_1 &lt;dbl&gt;, SDG3.3_2 &lt;dbl&gt;, SDG3.3_3 &lt;dbl&gt;,
## #   SDG3.3_4 &lt;dbl&gt;, SDG3.3_5 &lt;dbl&gt;, SDG3.4_1 &lt;dbl&gt;, SDG3.4_2 &lt;dbl&gt;,
## #   SDG3.4_3 &lt;dbl&gt;, SDG3.4_4 &lt;dbl&gt;, SDG3.4_5 &lt;dbl&gt;, SDG3.4_6 &lt;dbl&gt;,
## #   SDG3.5 &lt;dbl&gt;, SDG3.6 &lt;dbl&gt;, SDG3.8_1 &lt;dbl&gt;, SDG3.8_2 &lt;dbl&gt;, SDG3.9_1 &lt;dbl&gt;,
## #   SDG3.9_3 &lt;dbl&gt;, SDG3.b_1 &lt;dbl&gt;, SDG3.b_2 &lt;dbl&gt;, SDG3.b_3 &lt;dbl&gt;,
## #   SDG3.b_4 &lt;dbl&gt;, SDG3.c_1 &lt;dbl&gt;, SDG3.c_2 &lt;dbl&gt;, SDG3.c_3 &lt;dbl&gt;,
## #   SDG3.c_4 &lt;dbl&gt;, SDG3.d_1 &lt;dbl&gt;, SDG3.7 &lt;dbl&gt;, SDG3.a &lt;dbl&gt;, …</code></pre>
<p><code>pam()</code> can also provide the most representative example countries of each cluster. Note that the values inside are very different from that produced when we calculated the medians because <code>medoids</code> report the standardised data:</p>
<pre class="r"><code>SDGs_pam$medoids</code></pre>
<pre><code>##              other_1     other_2     SDG1.a     SDG16.1   SDG3.1_1   SDG3.2_1
## Togo      -1.3082283 -1.04437853 -1.1903643  0.06808945  1.1324894  1.3017843
## Nicaragua  0.3737688  0.08872107  1.3796506  0.08533933 -0.2323864 -0.2586716
## Czechia    0.8823411  0.61551298  0.8833042 -0.64737012 -0.6765494 -0.8435034
##             SDG3.2_2   SDG3.2_3   SDG3.3_1   SDG3.3_2   SDG3.3_3   SDG3.3_4
## Togo       1.4102734  1.3592849  0.1576964 -0.4579343  2.4882232  1.2835322
## Nicaragua -0.3767895 -0.3446689 -0.3154270 -0.4579343 -0.1580909 -0.6637395
## Czechia   -0.7133630 -0.7745694 -0.1376945 -0.7136379 -0.9480541 -0.5125539
##              SDG3.3_5   SDG3.4_1   SDG3.4_2   SDG3.4_3   SDG3.4_4    SDG3.4_5
## Togo      -0.06030043  1.2520369 -0.4762540 -0.6960758 -0.6952419 -0.07418662
## Nicaragua -0.16897721 -0.1601567  0.4796550 -0.5087310 -0.2996050 -0.62139368
## Czechia   -0.18762124 -0.9262184  0.1254489  1.1464418  0.3787484  0.33180571
##             SDG3.4_6     SDG3.5      SDG3.6   SDG3.8_1   SDG3.8_2   SDG3.9_1
## Togo      -0.2449637 -0.8481419  1.32097641 -0.2415269 -1.4304958  0.7715301
## Nicaragua -0.2418110 -0.2133414 -0.08575199 -0.2415269  0.5462165 -0.6816096
## Czechia   -0.1503081  2.0328759 -1.14835854  0.2417061  0.7438877 -0.2935552
##             SDG3.9_3    SDG3.b_1   SDG3.b_2   SDG3.b_3    SDG3.b_4   SDG3.c_1
## Togo       1.5236560  0.17567787 -1.0409470 -0.5061518 -0.02793898 -1.1831072
## Nicaragua -0.4682756 -0.03942639  0.2371043  0.7038002  0.94197637 -0.6102974
## Czechia   -0.5724488 -0.30874491  0.7352539  0.5525562  0.25560867  1.1612648
##             SDG3.c_2   SDG3.c_3   SDG3.c_4   SDG3.d_1     SDG3.7      SDG3.a
## Togo      -0.9983214 -1.1842216 -1.0940540 -1.0278904  0.8082986 -1.53587553
## Nicaragua -0.6958462  0.3067516  0.3246320  0.7660773 -0.2790219 -0.05503528
## Czechia    0.7385150  1.2426058  0.5534738  0.7415003 -0.9713149  1.07144665
##             SDG3.1_2   SDG3.b_5
## Togo      -1.3841046  0.7500056
## Nicaragua  0.5008573  0.1814304
## Czechia    0.9941603 -0.5157917</code></pre>
<p>We can do a coloured pairwise scatterplot to check data details. I limit it here to the pairs of the first 7 columns because of the large number of possible combinations:</p>
<pre class="r"><code>pairs(SDGs[, 3:10], col = c(&quot;#FC4E07&quot;, &quot;violetred3&quot;, &quot;deepskyblue3&quot;)[SDGs_pam$clustering])</code></pre>
<p><img src="/collection/quantecol/chapters/13-cluster_analysis_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div id="questions" class="section level3">
<h3>Questions</h3>
<p>This is the fnal set of questions for Quantitative Ecology.</p>
<ol style="list-style-type: decimal">
<li>What happens if we use <code>pam()</code> to create four, five, or even six clusters?</li>
<li>In your reasoned opinion, what would be the optimal number of clusters to use?</li>
<li>Repeat the analysis using either <code>kmeans()</code> or <code>hclust()</code>, and feel free to use the <strong>factoextra</strong> helper functions and visualisations. Are the results markedly different? Which clustering approach do you wish to proceed with—i.e., <code>pam()</code>, <code>hclust()</code> or <code>kmeans()</code>?</li>
<li>Build upon the narrative that you have already developed in the <a href="https://github.com/ajsmit/Quantitative_Ecology/blob/main/jupyter_lab/Topic_8-PCA-SDG-example.ipynb">previous assignment</a> and describe the patterns that you observe at the end of your final cluster selection (i.e. based on the optimal number of clusters and whichever cluster technique you deem most appropriate), and explain these patterns in terms of the global socio-political/socio-economic landscape.</li>
<li>Regardless of how many clusters you choose, South Africa often seems to teeter at the edge between the group of African countries and some other parent location. Why?</li>
</ol>
<p><span style="color:red">You are welcome to submit the entire asignment (the <a href="https://github.com/ajsmit/Quantitative_Ecology/blob/main/jupyter_lab/Topic_8-PCA-SDG-example.ipynb">previous assignment</a> and this one) in an R script wherein you provide answers to these questions by no later than 17:00 on Monday 2 August 2021.</span></p>
</div>
</div>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
    <a class="prev dtc pr2 tl v-top fw6"
    href="/workshops/quantecol/chapters/12-constrained_ordination/">&larr; 12. Constrained Ordination</a>
  
  
  
</div>

      </footer>
    </article>
    
      
<div class="post-comments pa0 pa4-l mt4">
  
  <script src="https://utteranc.es/client.js"
          repo="robwschlegel/heatwaveR"
          issue-term="pathname"
          theme="boxy-light"
          label="comments :crystal_ball:"
          crossorigin="anonymous"
          async
          type="text/javascript">
  </script>
  
</div>

    
  </section>
</main>

<aside class="page-sidebar" role="complementary">
                         
 











  <img src="/workshops/featured-sidebar.jpg" class="db ma0">

                         
 



<div class="flex items-start sticky ph4 pb4 flex-row">
  <div class="w-two-thirds w-50-l ph0">
    <h2 class="mv3 f5 fw7 ttu tracked">
      <a class="no-underline dim" href="/workshops/">Outline</a></h2>
    <nav id="SectionTableOfContents" aria-label="SectionTableOfContents">
        <ul>
        
          
          
          
          <details  class="">
            <summary class="" hugo-nav="/workshops/intro_r/"><a href="/workshops/intro_r/">BCB744 (Intro R)</a></summary>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/02-rstudio/"><a href="/workshops/intro_r/chapters/02-rstudio/">1. RStudio and R</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/03-github/"><a href="/workshops/intro_r/chapters/03-github/">2. GitHub</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/04-workflow/"><a href="/workshops/intro_r/chapters/04-workflow/">3. An R workflow</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/05-graphics/"><a href="/workshops/intro_r/chapters/05-graphics/">4. Graphics with ggplot2</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/06-faceting/"><a href="/workshops/intro_r/chapters/06-faceting/">5. Faceting figures</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/07-brewing/"><a href="/workshops/intro_r/chapters/07-brewing/">6. Brewing colours</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/08-mapping/"><a href="/workshops/intro_r/chapters/08-mapping/">7. Mapping with ggplot2</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/09-mapping_style/"><a href="/workshops/intro_r/chapters/09-mapping_style/">8. Mapping with style</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/10-mapping_openstreetmap/"><a href="/workshops/intro_r/chapters/10-mapping_openstreetmap/">9. Mapping with OpenStreetMap</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/11-tidy/"><a href="/workshops/intro_r/chapters/11-tidy/">10. Tidy data</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/12-tidier/"><a href="/workshops/intro_r/chapters/12-tidier/">11. Tidier data</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/13-tidiest/"><a href="/workshops/intro_r/chapters/13-tidiest/">12. Tidiest data</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/14-recap/"><a href="/workshops/intro_r/chapters/14-recap/">13. Recap</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/15-functions/"><a href="/workshops/intro_r/chapters/15-functions/">14. Functions by chapter</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/16-base_r/"><a href="/workshops/intro_r/chapters/16-base_r/">15. Base R primer</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/17-dates/"><a href="/workshops/intro_r/chapters/17-dates/">16. Dates</a></li>
            
          </details>
          
          </li>
        
          
          
          
          <details  class="">
            <summary class="" hugo-nav="/workshops/biostats/"><a href="/workshops/biostats/">BCB744 (Biostats)</a></summary>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/02-data/"><a href="/workshops/biostats/chapters/02-data/">1. Types of data</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/03-descriptive/"><a href="/workshops/biostats/chapters/03-descriptive/">2. Central tendency and dispersion</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/04-graphics/"><a href="/workshops/biostats/chapters/04-graphics/">3. Graphical data displays</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/06-t_tests/"><a href="/workshops/biostats/chapters/06-t_tests/">5. Inferences about one or two populations</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/07-anova/"><a href="/workshops/biostats/chapters/07-anova/">6. Analysis of Variance (ANOVA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/08-regressions/"><a href="/workshops/biostats/chapters/08-regressions/">7. Simple linear regressions</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/09-correlations/"><a href="/workshops/biostats/chapters/09-correlations/">8. Correlation</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/10-confidence/"><a href="/workshops/biostats/chapters/10-confidence/">9. Confidence intervals</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/11-transformations/"><a href="/workshops/biostats/chapters/11-transformations/">10. Data transformations</a></li>
            
          </details>
          
          </li>
        
          
          
          
          <details open class="active">
            <summary class="active" hugo-nav="/workshops/quantecol/"><a href="/workshops/quantecol/">BCB743</a></summary>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/01-data/"><a href="/workshops/quantecol/chapters/01-data/">1. Multivariate data</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/02-biodiversity/"><a href="/workshops/quantecol/chapters/02-biodiversity/">2. Biodiversity</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/03-deep_dive/"><a href="/workshops/quantecol/chapters/03-deep_dive/">3. Deep Dive into Gradients</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/04-env_dist/"><a href="/workshops/quantecol/chapters/04-env_dist/">4. Environmental Distance</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/05-spp_dissimilarity/"><a href="/workshops/quantecol/chapters/05-spp_dissimilarity/">5. Species Dissimilarities</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/06-correlations/"><a href="/workshops/quantecol/chapters/06-correlations/">6. Correlations and Associations</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/08_pca/"><a href="/workshops/quantecol/chapters/08_pca/">8a. Principal Component Analysis (PCA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/08-pca_sdg/"><a href="/workshops/quantecol/chapters/08-pca_sdg/">8b. PCA of WHO SDGs</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/09-ca/"><a href="/workshops/quantecol/chapters/09-ca/">9. Correspondence Analysis (CA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/10-pcoa/"><a href="/workshops/quantecol/chapters/10-pcoa/">10. Principal Coordinate Analysis (PCoA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/11-nmds/"><a href="/workshops/quantecol/chapters/11-nmds/">11a. non-Metric multidimensional scaling (nMDS)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/11-nmds_diatoms/"><a href="/workshops/quantecol/chapters/11-nmds_diatoms/">11b. nMDS of Mayombo&#39;s diatom data</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/12-constrained_ordination/"><a href="/workshops/quantecol/chapters/12-constrained_ordination/">12. Constrained Ordination</a></li>
            
              
              <li class="active" hugo-nav="/workshops/quantecol/chapters/13-cluster_analysis/"><a href="/workshops/quantecol/chapters/13-cluster_analysis/">13. Cluster analysis</a></li>
            
          </details>
          
          </li>
        
        </ul>
    </nav>
  </div>
  <details id="PageTableOfContents">
    <summary><h2 class="mv0 f5 fw7 ttu tracked dib">On this page<h2></summary>
    <div class="pl2 pr0 mh0">
    
    </div>
  </details>
  
</div>

</aside>

<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2022 University of the Western Cape, Cape Town
      <span class="middot-divider"></span>
      Made with <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo Apéro</a></span>.
      <br />
      
Based on <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0">
      <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/ajsmit/" title="github" target="_blank" rel="noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="http://orcid.org/0000-0002-3799-6126" title="orcid" target="_blank" rel="noopener">
      <i class="ai ai-orcid fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.researchgate.net/profile/Albertus-Smit" title="researchgate" target="_blank" rel="noopener">
      <i class="ai ai-researchgate fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://uwc.academia.edu/AlbertusSmit" title="academia" target="_blank" rel="noopener">
      <i class="ai ai-academia fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://scholar.google.co.za/citations?user=ATsBBKoAAAAJ&amp;hl=en" title="google-scholar" target="_blank" rel="noopener">
      <i class="ai ai-google-scholar fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.instagram.com/ajsmit/" title="instagram" target="_blank" rel="noopener">
      <i class="fab fa-instagram fa-lg fa-fw"></i>
    </a>
  
</div>

    </div>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
      <a class="dib pv1 ph2 link" href="/license/" title="License">License</a>
      
      <a class="dib pv1 ph2 link" href="/contact/" title="Contact form">Contact</a>
      
      <a class="dib pv1 ph2 link" href="/contributors/" title="Contributors">Contributors</a>
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>
