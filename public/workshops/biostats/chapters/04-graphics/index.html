<!DOCTYPE html>
<html lang="en" dir="ltr"><head>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.96.0" />
<title>3. Graphical data displays | BCB R Stats Pages</title>


<meta property="twitter:site" content="@ajsmit">
<meta property="twitter:creator" content="@ajsmit">







  
    
  
<meta name="description" content="What you need to know upfront.">


<meta property="og:site_name" content="BCB R Stats Pages">
<meta property="og:title" content="3. Graphical data displays | BCB R Stats Pages">
<meta property="og:description" content="What you need to know upfront." />
<meta property="og:type" content="page" />
<meta property="og:url" content="/workshops/biostats/chapters/04-graphics/" />
<meta property="og:locale" content="en">




    
        <meta property="og:image" content="/img/papillons.jpg" >
        <meta property="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="/img/papillons.jpg" >
    
  <meta itemprop="name" content="3. Graphical data displays">
<meta itemprop="description" content="library(tidyverse) library(ggpubr) library(RColorBrewer) library(ggthemes) Here we shall provide examples of many kinds of graphical data summaries. We use ggplot2 for these figures and will refrain from using the base R graphs. We shall provide examples of various themes so you can see what is available to use for your own plots. We also include various modifications of the default plots so you can get an idea of how to modify some of the plot characteristics, and we always make sure that our graphs are publication ready."><meta itemprop="datePublished" content="2021-01-01T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-01-01T00:00:00+00:00" />
<meta itemprop="wordCount" content="3133">
<meta itemprop="keywords" content="" />
  
  
  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.13dd27d3efb7ed4ad82be3040182ddbf5ab9d3b4d6d01f0ba3930845932fce66.css" integrity="sha256-E90n0&#43;&#43;37UrYK&#43;MEAYLdv1q507TW0B8Lo5MIRZMvzmY=" media="screen">
  
  
  <script src="/panelset.min.8f4cba0107356728f266d94a12a4d18ef504eda8a9a284cda73675bae7884a68.js" type="text/javascript"></script>
  
  
  <script src="/main.min.318ee9c0652bba0149e7503c97e37e638937f3a9cad9233e6d0ba00bf7a46a5e.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container single-series">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="/" title="Home">
      <img src="/img/xaringan-outline.png" class="dib db-l h2 w-auto" alt="BCB R Stats Pages">
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="About AJ Smit">About</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/workshops/" title="BCB Hons">BCB Hons</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/project/" title="Project Portfolio">Projects</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/collection/" title="R Courses">R Courses</a>
      
      
    </div>
  </nav>
</header>


<main class="page-main ph4 pt4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 pr3-l">
      <header class="post-header">
        <h4 class="breadcrumb pb5">

  
    
      
  
    
      
  
    
      
  

    
    
      <a href="/workshops/">B.Sc. (Hons.) R modules</a>
    
  

    
    
      <a href="/workshops/biostats/">BCB744 (Biostats)</a>
    
  

    
    
      3. Graphical data displays
    
  

</h4>




        
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">3. Graphical data displays</h1>
        
        <p class="f6 measure lh-copy mv1"></p>
        <p class="f7 db mv0 ttu">January 1, 2021</p>
        
        
      
      <div class="ph0 pt5">
        
    
    
    
    
    
    
    
      
      
  <a class="btn-links mr2 ba dib" href="https://ajsmit.github.io/BCB744/graphics_exercises.html" target="_blank" rel="noopener"><i class="fa fa-star fa-lg fa-fw mr2"></i>Graphics Exercises</a>


      </div>
      
        
      </header>
      <section class="post-body pt5 pb4">
        


<!--- # Graphical data displays --->
<pre class="r"><code>library(tidyverse)
library(ggpubr)
library(RColorBrewer)
library(ggthemes)</code></pre>
<p>Here we shall provide examples of many kinds of graphical data summaries. We use <strong>ggplot2</strong> for these figures and will refrain from using the base R graphs. We shall provide examples of various themes so you can see what is available to use for your own plots. We also include various modifications of the default plots so you can get an idea of how to modify some of the plot characteristics, and we always make sure that our graphs are publication ready. The best way to learn is to work by example. Deeper understanding will emerge only from working through all of these example plots, and making your own changes here and there to see how your own modification will affect your graphs’ appearance. Then find your own data and plot them. As always, liberally make use of the built-in help facility (the more you do, the easier it becomes, like riding a bicycle). Also, don’t be shy to use Google.</p>
<div id="qualitative-data" class="section level2">
<h2>Qualitative data</h2>
<p>Qualitative data that describe group representivity to various categories are best presented as frequency distribution histograms (I interchangeably use histograms, frequency histograms, and frequency distribution histograms). Histograms apply to categorical data. Although it can be presented numerically in tabular form, one more frequently creates a bar or pie graph of the number of occurrences in a collection of non-overlapping classes or categories. Both the data and graphical displays will be demonstrated here.</p>
<p>The first case of a frequency distribution histogram is one that shows the raw counts per each of the categories that are represented in the data. The count within each of the categories (represented by a bar graph called a histogram) sums to the sample size, <span class="math inline">\(n\)</span>. In the second case, we may want to report those data as proportions. Here we show the frequency proportion in a collection of non-overlapping categories. For example, we have a sample size of 12 (<span class="math inline">\(n=12\)</span>). In this sample, two are coloured blue, six red, and five purple. The relative proportions are <span class="math inline">\(2/12=0.1666667\)</span> blue, <span class="math inline">\(6/12=0.5\)</span> red, and <span class="math inline">\(5/12=0.4166667\)</span> purple. The important thing to note here is that the relative proportions sum to 1, i.e. <span class="math inline">\(0.1666667+0.5+0.4166667=1\)</span>. These data may be presented as a table or as a graph.</p>
<p>Let us demonstrate the numerical and graphical summaries using the built-in <code>iris</code> data:</p>
<pre class="r"><code># the numerical summary produced by a piped series of functions;
# create a summary of the data (i.e. number of replicates per species)
# used for (A), (B) and (C), below
iris.cnt &lt;- iris %&gt;%
  count(Species) %&gt;% # automagically creates a column, n, with the counts
  mutate(prop = n / sum(n)) # creates the relative proportion of each species
iris.cnt</code></pre>
<pre><code>R&gt;      Species  n      prop
R&gt; 1     setosa 50 0.3333333
R&gt; 2 versicolor 50 0.3333333
R&gt; 3  virginica 50 0.3333333</code></pre>
<!-- show example of frequency distribution bar graph -->
<pre class="r"><code># a stacked bar graph with the cumulative sum of observations
plt1 &lt;- ggplot(data = iris.cnt, aes(x = &quot;&quot;, y = n, fill = Species)) +
  geom_bar(width = 1, stat = &quot;identity&quot;) +
  labs(title = &quot;Stacked bar graph&quot;, subtitle = &quot;cumulative sum&quot;,
       x = NULL, y = &quot;Count&quot;) +
  theme_pubclean() + scale_color_few() +
  scale_fill_few()

# a stacked bar graph with the relative proportions of observations
plt2 &lt;- ggplot(data = iris.cnt, aes(x = &quot;&quot;, y = prop, fill = Species)) +
  geom_bar(width = 1, stat = &quot;identity&quot;) +
  scale_y_continuous(breaks = c(0.00, 0.33, 0.66, 1.00)) +
  labs(title = &quot;Stacked bar graph&quot;, subtitle = &quot;relative proportions&quot;,
       x = NULL, y = &quot;Proportion&quot;) +
  theme_pubclean() + scale_color_few() +
  scale_fill_few()

# a basic pie chart
plt3 &lt;- plt1 + coord_polar(&quot;y&quot;, start = 0) +
  labs(title = &quot;Friends don&#39;t let...&quot;, subtitle = &quot;...friends make pie charts&quot;,
       x = NULL, y = NULL) +
  scale_fill_brewer(palette = &quot;Blues&quot;) +
  theme_minimal()
# if you seriously want a pie chart, rather use the base R function, `pie()`

# here now a bar graph...
# the default mapping of `geom_bar` is `stat = count`, which is a
# bar for each fo the categories (`Species`), with `count` along y
plt4 &lt;- ggplot(data = iris, aes(x = Species, fill = Species)) +
  geom_bar(show.legend = FALSE) +
  labs(title = &quot;Side-by-side bars&quot;, subtitle = &quot;n per species&quot;, y = &quot;Count&quot;) +
 theme_pubclean() + scale_color_few() +
  scale_fill_few()

ggarrange(plt1, plt2, plt3, plt4, nrow = 2, ncol = 2, labels = &quot;AUTO&quot;)</code></pre>
<div class="figure"><span style="display:block;" id="fig:graphics-plot1"></span>
<img src="/collection/biostats/chapters/04-graphics_files/figure-html/graphics-plot1-1.png" alt="Examples of histograms for the built-in Iris data. A) A default frequency histogram showing the count of samples for each of the three species. B) A relative frequency histogram of the same data; here, the sum of counts of samples available for each of the three species is 1. C) A boring pie chart. D) A frequency histogram of raw data counts shown as a series of side-by-side bars." width="70%" />
<p class="caption">
Figure 1: Examples of histograms for the built-in Iris data. A) A default frequency histogram showing the count of samples for each of the three species. B) A relative frequency histogram of the same data; here, the sum of counts of samples available for each of the three species is 1. C) A boring pie chart. D) A frequency histogram of raw data counts shown as a series of side-by-side bars.
</p>
</div>
</div>
<div id="continuous-data" class="section level2">
<h2>Continuous data</h2>
<div id="frequency-distributions-histograms" class="section level3">
<h3>Frequency distributions (histograms)</h3>
<p>As with discrete data, we have a choice of absolute (Fig. 4.2A) and relative (Fig. 4.2 B-C) frequency histograms. There’s also the empirical cumulative distribution function (ECDF) (Fig. 4.2 D) that uses relative proportions, but in this instance it is the relative proportion that each individual observation has towards the sample. Since the purpose of frequency histograms is to count the number of times something takes place or occurs within a category, what do we do when we are faced with continuous data where no categories are available? We can create our own categories, called <em>bins</em>. See the Old Faithful data, for example. The eruptions last between 1.6 and 5.1 minutes. So, we create intervals of time spanning these times, and within each count the number of times an event lasts as long as denoted by the intervals. Here we might choose intervals of 1-2 minutes, 2-3 minutes, 3-4 minutes, 4-5 minutes, and 5-6 minutes. The <strong>ggplot2</strong> <code>geom_histogram()</code> function automatically creates the bins, but we may specify our own. It is best to explain these principles by example (see Figure 4.2 A-D).</p>
<!-- show example of numerical summary -->
<pre class="r"><code># a normal frequency histogram, with count along y
hist1 &lt;- ggplot(data = faithful, aes(x = eruptions)) +
  geom_histogram(colour = &quot;black&quot;, fill = &quot;salmon&quot;, alpha = 0.6) +
  labs(title = &quot;Old Faithful data&quot;,
       subtitle = &quot;A vanilla frequency histogram&quot;,
       x = &quot;Eruption duration (min)&quot;,
       y = &quot;Count&quot;) + theme_pubclean()

# when the binwidth is 1, the density histogram *is* the relative
# frequency histogram
hist2 &lt;- ggplot(data = faithful, aes(x = eruptions)) +
  geom_histogram(aes(y = ..density..),
                 position = &#39;identity&#39;, binwidth = 1,
                 colour = &quot;black&quot;, fill = &quot;salmon&quot;, alpha = 0.6) +
  labs(title = &quot;Old Faithful data&quot;,
       subtitle = &quot;Relative frequency histogram&quot;,
       x = &quot;Eruption duration (min)&quot;,
       y = &quot;Count&quot;) + theme_pubclean()


# if binwidth is something other than 1, the relative frequency in
# a histogram is ..density.. * binwidth
hist3 &lt;- ggplot(data = faithful, aes(x = eruptions)) +
  geom_histogram(aes(y = 0.5 * ..density..),
                 position = &#39;identity&#39;, binwidth = 0.5,
                 colour = &quot;black&quot;, fill = &quot;salmon&quot;, alpha = 0.6) +
  labs(title = &quot;Old Faithful data&quot;,
       subtitle = &quot;Relative frequency histogram&quot;,
       x = &quot;Eruption duration (min)&quot;,
       y = &quot;Relative contribution&quot;) + theme_pubclean()

# ECDF
hist4 &lt;- ggplot(data = faithful, aes(x = eruptions)) + 
  stat_ecdf() +
  labs(title = &quot;Old Faithful data&quot;,
       subtitle = &quot;ECDF&quot;,
       x = &quot;Eruption duration (min)&quot;,
       y = &quot;Relative contribution&quot;) + theme_pubclean()

ggarrange(hist1, hist2, hist3, hist4, ncol = 2, nrow = 2, labels = &quot;AUTO&quot;)</code></pre>
<div class="figure"><span style="display:block;" id="fig:graphics-plot2"></span>
<img src="/collection/biostats/chapters/04-graphics_files/figure-html/graphics-plot2-1.png" alt="Example histograms for the Old Faithful data. A) A default frequency histogram with the count of eruption times falling within the specified bins. B) A relative frequency histogram with bins adjusted to a width of 1 minute intervals; here, the sum of counts within each of the four bins is 1. C) Another relative frequency histogram, but with the bins adjusted to each be 0.5 minute increments; again the sum of counts represented by each bin is equal to 1." width="70%" />
<p class="caption">
Figure 2: Example histograms for the Old Faithful data. A) A default frequency histogram with the count of eruption times falling within the specified bins. B) A relative frequency histogram with bins adjusted to a width of 1 minute intervals; here, the sum of counts within each of the four bins is 1. C) Another relative frequency histogram, but with the bins adjusted to each be 0.5 minute increments; again the sum of counts represented by each bin is equal to 1.
</p>
</div>
<p>What if we have continuous data belonging with multiple categories? The <code>iris</code> data provide a nice set of measurements that we may use to demonstrate a grouped frequency histogram. These data are size measurements (cm) of the variables sepal length and width and petal length and width, respectively, for 50 flowers from each of three species of <em>Iris</em>. The species are <em>Iris setosa</em>, <em>I. versicolor</em>, and <em>I. virginica</em>.</p>
<pre class="r"><code># first we make long data
iris.long &lt;- iris %&gt;% 
  gather(key = &quot;variable&quot;, value = &quot;size&quot;, -Species)

ggplot(data = iris.long, aes(x = size)) +
  geom_histogram(position = &quot;dodge&quot;, # ommitting this creates a stacked histogram
                 colour = NA, bins = 20,
                 aes(fill = Species)) +
  facet_wrap(~variable) +
  labs(title = &quot;Iris data&quot;,
       subtitle = &quot;Grouped frequency histogram&quot;,
       x = &quot;Size (cm)&quot;,
       y = &quot;Count&quot;) +
  theme_pubclean()</code></pre>
<div class="figure"><span style="display:block;" id="fig:graphics-plot3"></span>
<img src="/collection/biostats/chapters/04-graphics_files/figure-html/graphics-plot3-1.png" alt="Panelled grouped histograms for the four Iris variables." width="70%" />
<p class="caption">
Figure 3: Panelled grouped histograms for the four Iris variables.
</p>
</div>
</div>
<div id="box-plots" class="section level3">
<h3>Box plots</h3>
<p>Box plots are sometimes called box-and-whisker plots. These graphs are a a graphical representation of the data based on its quartiles as well as its smallest and largest values. The keen eye can glance the ‘shape’ of the data distribution; they provide an alternative view to that given by the frequency distribution. A variation of the basic box-and-whisker plot is to superimpose a jittered scatter plot of the raw data on each bar.</p>
<p>From the <code>geom_boxplot</code> documentation, which says it best (type <code>?geom_boxplot</code>):</p>
<p>“The lower and upper hinges correspond to the first and third quartiles (the 25th and 75th percentiles).”</p>
<p>“The upper whisker extends from the hinge to the largest value no further than 1.5 * IQR from the hinge (where IQR is the inter-quartile range, or distance between the first and third quartiles). The lower whisker extends from the hinge to the smallest value at most 1.5 * IQR of the hinge. Data beyond the end of the whiskers are called ‘outlying’ points and are plotted individually.”</p>
<p>“In a notched box plot, the notches extend 1.58 * IQR / sqrt(n). This gives a roughly 95% confidence interval for comparing medians.”</p>
<p>Here be examples:</p>
<pre class="r"><code>library(ggsci) # for nice colours

plt1 &lt;- ggplot(data = iris, aes(x = Species, y = Sepal.Length, fill = Species)) +
  geom_boxplot(show.legend = FALSE, notch = FALSE) +
  scale_fill_npg() +
  theme_linedraw() +
  labs(y = &quot;Sepal length (cm)&quot;) +
  theme(axis.text.x = element_text(face = &quot;italic&quot;))

plt2 &lt;- ggplot(data = iris.long, aes(x = Species, y = size)) +
  geom_boxplot(alpha = 0.4, notch = TRUE) +
  geom_jitter(width = 0.1, shape = 21, fill = NA,
              alpha = 0.2, aes(colour = as.factor(Species))) +
  facet_wrap(~variable, nrow = 1) +
  scale_color_npg() +
  labs(y = &quot;Size (cm)&quot;) +
  theme_linedraw() +
  theme(axis.text.x = element_text(face = &quot;italic&quot;))

ggarrange(plt1, plt2, nrow = 2, ncol = 1, labels = &quot;AUTO&quot;)</code></pre>
<div class="figure"><span style="display:block;" id="fig:graphics-plot4a"></span>
<img src="/collection/biostats/chapters/04-graphics_files/figure-html/graphics-plot4a-1.png" alt="Examples of box plots made for the Iris data. A) A default box plot for one of the variables only. B) A panelled collection of box plots, one for each of the four variables, with a scatterplot to indicate the spread of the actual replicates." width="70%" />
<p class="caption">
Figure 4: Examples of box plots made for the Iris data. A) A default box plot for one of the variables only. B) A panelled collection of box plots, one for each of the four variables, with a scatterplot to indicate the spread of the actual replicates.
</p>
</div>
<p>Box-and-whisker plots have traditionally been used to display data that are not normally distributed, but I like to use them for any old data, even normal data. I prefer these over the old-fashioned bar graphs (as seen later in this section).</p>
<p>There are many additional packages that can be used to create an assortment of plots suitable to represent summary statistics and various ways to visualise group differences. For example, the package <a href="https://github.com/IndrajeetPatil/ggstatsplot">ggstatplot</a> has many great options, for example this <em>violin plot</em>:</p>
<pre class="r"><code># for reproducibility
library(ggstatsplot)
set.seed(123)

# plot
ggstatsplot::ggbetweenstats(
  data = iris,
  x = Species,
  y = Sepal.Length,
  ylab = &quot;Sepal Length (cm)&quot;,
  title = &quot;Distribution of sepal length across Iris species&quot;
)</code></pre>
<div class="figure"><span style="display:block;" id="fig:graphics-plot4b"></span>
<img src="/collection/biostats/chapters/04-graphics_files/figure-html/graphics-plot4b-1.png" alt="Examples of violin plots made for the Iris data." width="70%" />
<p class="caption">
Figure 5: Examples of violin plots made for the Iris data.
</p>
</div>
<p>The <strong>ggpubr</strong> package provides many convenience functions for the drawing of publication quality graphs, many of which include summaries of pairwise comparisons (e.g. in t-tests and ANOVAs). Please see <a href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/">here</a> and <a href="http://www.sthda.com/english/rpkgs/ggpubr/">here</a>.</p>
</div>
<div id="pairwise-scatter-plots" class="section level3">
<h3>Pairwise Scatter plots</h3>
<p>This graph shows the relationship between two (matched) continuous variables. The statistical strength of the relationship can be indicated by a correlation (no causal relationship implied as is the case here) or a regression (when a causal link of <span class="math inline">\(x\)</span> on <span class="math inline">\(y\)</span> is demonstrated).</p>
<pre class="r"><code>plt1 &lt;- ggplot(data = iris, aes(x = Petal.Length, y = Petal.Width, colour = Species)) +
  geom_point() +
  labs(x = &quot;Petal length (cm)&quot;, y = &quot;Petal width (cm)&quot;) +
  theme(legend.position = c(0.18, 0.85)) +
  scale_color_fivethirtyeight() +
  scale_fill_fivethirtyeight() + 
  theme_pubclean()

plt2 &lt;- ggplot(data = iris, aes(x = Petal.Length, y = Petal.Width, colour = Species)) +
  geom_point(show.legend = FALSE) +
  geom_smooth(method = &quot;lm&quot;, se = FALSE, show.legend = FALSE) +
  scale_color_fivethirtyeight() +
  scale_fill_fivethirtyeight() +
  labs(x = &quot;Petal length (cm)&quot;, y = &quot;Petal width (cm)&quot;) + 
  theme_pubclean()

ggarrange(plt1, plt2, ncol = 2, nrow = 1, labels = &quot;AUTO&quot;)</code></pre>
<div class="figure"><span style="display:block;" id="fig:graphics-plot5"></span>
<img src="/collection/biostats/chapters/04-graphics_files/figure-html/graphics-plot5-1.png" alt="Examples of scatterplots made for the Iris data. A) A default scatter plot showing the relationship between petal length and width. B) The same as (A) but with a correlation line added." width="70%" />
<p class="caption">
Figure 6: Examples of scatterplots made for the Iris data. A) A default scatter plot showing the relationship between petal length and width. B) The same as (A) but with a correlation line added.
</p>
</div>
</div>
<div id="bar-graphs" class="section level3">
<h3>Bar graphs</h3>
<p>Bar graphs display the mean plus/minus some measure of variation around the mean—typically the standard error or the standard deviation. The mean±SE and mean±SD are typically used for normally-distributed data. Here I provide an example bar graph for one of the Iris data set’s variables:</p>
<pre class="r"><code># first make nice labels for the facets because the default ones
# in the dataframe are not so nice; use the `labeller()` function
# to receive the new variable names defined here
facet.names &lt;- c(Petal.Length = &quot;Petal length&quot;,
                 Petal.Width = &quot;Petal width&quot;,
                 Sepal.Length = &quot;Sepal length&quot;,
                 Sepal.Width = &quot;Sepal width&quot;)

# start with the `iris.long` long data that were produced above
# we create summaries of mean and SD and squirt it directly
# into the ggplot functions
iris.long %&gt;% 
  group_by(Species, variable) %&gt;%
  summarise(mean.size = mean(size),
            sd.size = sd(size)) %&gt;%
  ggplot(aes(x = Species, y = mean.size)) +
  geom_bar(stat = &quot;identity&quot;) +
  geom_errorbar(aes(ymin = mean.size - sd.size, ymax = mean.size + sd.size), width = 0.2) +
  facet_wrap(~variable, labeller = labeller(variable = facet.names)) +
  labs(y = &quot;Size (cm)&quot;, title = &quot;A box plot...&quot;, subtitle = &quot;...of the Iris data&quot;) +
  theme(axis.text.x = element_text(face = &quot;italic&quot;))</code></pre>
<div class="figure"><span style="display:block;" id="fig:graphics-plot6"></span>
<img src="/collection/biostats/chapters/04-graphics_files/figure-html/graphics-plot6-1.png" alt="Box plots of the mean ± SD of the four Iris variables." width="70%" />
<p class="caption">
Figure 7: Box plots of the mean ± SD of the four Iris variables.
</p>
</div>
</div>
<div id="density-graphs" class="section level3">
<h3>Density graphs</h3>
<p>Often when we are displaying a distribution of data we are interested in the “shape” of the data more than the actual count of values in a specific category, as shown by a standard histogram. When one wishes to more organically visualise the frequency of values in a sample set a density graphs is used. These may also be thought of as smooth histograms. These work well with histograms and rug plots, as we may see in the figure below. It is important to note with density plots that they show the relative density of the distribution along the Y axis, and <em>not</em> the counts of the data. This can of course be changed, as seen below, but is not the default setting. Sometimes it can be informative to see how different the count and density distributions appear.</p>
<pre class="r"><code># a normal density graph
dens1 &lt;- ggplot(data = faithful, aes(x = eruptions)) +
  geom_density(colour = &quot;black&quot;, fill = &quot;salmon&quot;, alpha = 0.6) +
  labs(title = &quot;Old Faithful data&quot;,
       subtitle = &quot;A vanilla density plot&quot;,
       x = &quot;Eruption duration (min)&quot;,
       y = &quot;Density&quot;) + theme_pubr()

# a density and rug plot combo
dens2 &lt;- ggplot(data = faithful, aes(x = eruptions)) +
  geom_density(colour = &quot;black&quot;, fill = &quot;salmon&quot;, alpha = 0.6) +
  geom_rug(colour = &quot;red&quot;) +
  labs(title = &quot;Old Faithful data&quot;,
       subtitle = &quot;A density and rug plot&quot;,
       x = &quot;Eruption duration (min)&quot;,
       y = &quot;Density&quot;) + theme_pubr()

# a relative frequency histogram overlayed with a density plot
dens3 &lt;- ggplot(data = faithful, aes(x = eruptions)) +
  geom_histogram(aes(y = ..density..),
                 position = &#39;identity&#39;, binwidth = 1,
                 colour = &quot;black&quot;, fill = &quot;turquoise&quot;, alpha = 0.6) +
  geom_density(colour = &quot;black&quot;, fill = &quot;salmon&quot;, alpha = 0.6) +
  labs(title = &quot;Old Faithful data&quot;,
       subtitle = &quot;Relative frequency with density&quot;,
       x = &quot;Eruption duration (min)&quot;,
       y = &quot;Density&quot;) + theme_pubr()

# a normal frequency histogram with density overlayed
# note that the density curve must be adjusted by
# the number of data points times the bin width
dens4 &lt;- ggplot(data = faithful, aes(x = eruptions)) +
  geom_histogram(aes(y = ..count..),
                 binwidth = 0.2, colour = &quot;black&quot;, fill = &quot;turquoise&quot;, alpha = 0.6) +
  geom_density(aes(y = ..density.. * nrow(datasets::faithful) * 0.2), position = &quot;identity&quot;,
               colour = &quot;black&quot;, fill = &quot;salmon&quot;, alpha = 0.6) +
  labs(title = &quot;Old Faithful data&quot;,
       subtitle = &quot;Frequency with density&quot;,
       x = &quot;Eruption duration (min)&quot;,
       y = &quot;Count&quot;) + theme_pubr()

ggarrange(dens1, dens2, dens3, dens4, ncol = 2, nrow = 2, labels = &quot;AUTO&quot;)</code></pre>
<div class="figure"><span style="display:block;" id="fig:graphics-plot7"></span>
<img src="/collection/biostats/chapters/04-graphics_files/figure-html/graphics-plot7-1.png" alt="A bevy of density graphs option based on the iris data. A) A lone density graph. B) A density graph accompanied by a rug plot. C) A histogram with a density graph overlay. D) A ridge plot." width="70%" />
<p class="caption">
Figure 8: A bevy of density graphs option based on the iris data. A) A lone density graph. B) A density graph accompanied by a rug plot. C) A histogram with a density graph overlay. D) A ridge plot.
</p>
</div>
</div>
<div id="violin-plots" class="section level3">
<h3>Violin plots</h3>
<p>The density graph is not limited to it’s use with histograms. We may combine this concept with box plots, too. These are known as violin plots and are very useful when we want to show the distribution of multiple categories of the same variable alongside one another. Violin plots may show the same information as box plots but take things one step further by allowing the shape of the boxplot to also show the distribution of the data within the sample set. We will use the <code>iris</code> data below to highlight the different types of violin plots one may use.</p>
<pre class="r"><code># A basic violin plot
vio1 &lt;- ggplot(data = iris, aes(x = Species, y = Sepal.Length, fill = Species)) +
  geom_violin() + 
  theme_pubclean() + theme(legend.position = &quot;none&quot;) +
  labs(title = &quot;Iris data&quot;,
       subtitle = &quot;Basic violin plot&quot;, y = &quot;Sepal length (cm)&quot;) +
  theme(axis.text.x = element_text(face = &quot;italic&quot;))

# Aviolin plot showing the quartiles as lines
vio2 &lt;- ggplot(data = iris, aes(x = Species, y = Sepal.Length, fill = Species)) +
  geom_violin(show.legend = FALSE, draw_quantiles = c(0.25, 0.5, 0.75)) + 
  theme_pubclean() + theme(legend.position = &quot;none&quot;) +
  labs(title = &quot;Iris data&quot;,
       subtitle = &quot;Violin plot with quartiles&quot;, y = &quot;Sepal length (cm)&quot;) +
  theme(axis.text.x = element_text(face = &quot;italic&quot;))

# Box plots nested within violin plots
vio3 &lt;- ggplot(data = iris, aes(x = Species, y = Sepal.Length, colour = Species)) +
  geom_violin(fill = &quot;grey70&quot;) + 
  geom_boxplot(width = 0.1, colour = &quot;grey30&quot;, fill = &quot;white&quot;) +
  theme_pubclean() + theme(legend.position = &quot;none&quot;) +
  labs(title = &quot;Iris data&quot;,
       subtitle = &quot;Box plots nested within violin plots&quot;, y = &quot;Sepal length (cm)&quot;) +
  theme(axis.text.x = element_text(face = &quot;italic&quot;))

# Boxes in violins with the raw data jittered about
vio4 &lt;- ggplot(data = iris, aes(x = Species, y = Sepal.Length, colour = Species)) +
  geom_violin(fill = &quot;grey70&quot;) + 
  geom_boxplot(width = 0.1, colour = &quot;black&quot;, fill = &quot;white&quot;) +
  geom_jitter(shape = 1, width = 0.1, colour = &quot;red&quot;, alpha = 0.7, fill = NA) +
  theme_pubclean() + theme(legend.position = &quot;none&quot;) +
  labs(title = &quot;Iris data&quot;,
       subtitle = &quot;Violins, boxes, and jittered data&quot;, y = &quot;Sepal length (cm)&quot;) +
  theme(axis.text.x = element_text(face = &quot;italic&quot;))

ggarrange(vio1, vio2, vio3, vio4, ncol = 2, nrow = 2, labels = &quot;AUTO&quot;)</code></pre>
<div class="figure"><span style="display:block;" id="fig:graphics-plot8"></span>
<img src="/collection/biostats/chapters/04-graphics_files/figure-html/graphics-plot8-1.png" alt="Variations of violin plots." width="70%" />
<p class="caption">
Figure 9: Variations of violin plots.
</p>
</div>
</div>
</div>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
    <a class="prev dtc pr2 tl v-top fw6"
    href="/workshops/biostats/chapters/03-descriptive/">&larr; 2. Central tendency and dispersion</a>
  
  
  
    <a class="next dtc pl2 tr v-top fw6"
    href="/workshops/biostats/chapters/06-t_tests/">5. Inferences about one or two populations &rarr;</a>
  
</div>

      </footer>
    </article>
    
      
<div class="post-comments pa0 pa4-l mt4">
  
  <script src="https://utteranc.es/client.js"
          repo="robwschlegel/heatwaveR"
          issue-term="pathname"
          theme="boxy-light"
          label="comments :crystal_ball:"
          crossorigin="anonymous"
          async
          type="text/javascript">
  </script>
  
</div>

    
  </section>
</main>

<aside class="page-sidebar" role="complementary">
                         
 











  <img src="/workshops/featured-sidebar.jpg" class="db ma0">

                         
 



<div class="flex items-start sticky ph4 pb4 flex-row">
  <div class="w-two-thirds w-50-l ph0">
    <h2 class="mv3 f5 fw7 ttu tracked">
      <a class="no-underline dim" href="/workshops/">Outline</a></h2>
    <nav id="SectionTableOfContents" aria-label="SectionTableOfContents">
        <ul>
        
          
          
          
          <details  class="">
            <summary class="" hugo-nav="/workshops/intro_r/"><a href="/workshops/intro_r/">BCB744 (Intro R)</a></summary>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/02-rstudio/"><a href="/workshops/intro_r/chapters/02-rstudio/">1. RStudio and R</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/03-github/"><a href="/workshops/intro_r/chapters/03-github/">2. GitHub</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/04-workflow/"><a href="/workshops/intro_r/chapters/04-workflow/">3. An R workflow</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/05-graphics/"><a href="/workshops/intro_r/chapters/05-graphics/">4. Graphics with ggplot2</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/06-faceting/"><a href="/workshops/intro_r/chapters/06-faceting/">5. Faceting figures</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/07-brewing/"><a href="/workshops/intro_r/chapters/07-brewing/">6. Brewing colours</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/08-mapping/"><a href="/workshops/intro_r/chapters/08-mapping/">7. Mapping with ggplot2</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/09-mapping_style/"><a href="/workshops/intro_r/chapters/09-mapping_style/">8. Mapping with style</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/10-mapping_openstreetmap/"><a href="/workshops/intro_r/chapters/10-mapping_openstreetmap/">9. Mapping with OpenStreetMap</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/11-tidy/"><a href="/workshops/intro_r/chapters/11-tidy/">10. Tidy data</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/12-tidier/"><a href="/workshops/intro_r/chapters/12-tidier/">11. Tidier data</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/13-tidiest/"><a href="/workshops/intro_r/chapters/13-tidiest/">12. Tidiest data</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/14-recap/"><a href="/workshops/intro_r/chapters/14-recap/">13. Recap</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/15-functions/"><a href="/workshops/intro_r/chapters/15-functions/">14. Functions by chapter</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/16-base_r/"><a href="/workshops/intro_r/chapters/16-base_r/">15. Base R primer</a></li>
            
              
              <li class="" hugo-nav="/workshops/intro_r/chapters/17-dates/"><a href="/workshops/intro_r/chapters/17-dates/">16. Dates</a></li>
            
          </details>
          
          </li>
        
          
          
          
          <details open class="active">
            <summary class="active" hugo-nav="/workshops/biostats/"><a href="/workshops/biostats/">BCB744 (Biostats)</a></summary>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/02-data/"><a href="/workshops/biostats/chapters/02-data/">1. Types of data</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/03-descriptive/"><a href="/workshops/biostats/chapters/03-descriptive/">2. Central tendency and dispersion</a></li>
            
              
              <li class="active" hugo-nav="/workshops/biostats/chapters/04-graphics/"><a href="/workshops/biostats/chapters/04-graphics/">3. Graphical data displays</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/06-t_tests/"><a href="/workshops/biostats/chapters/06-t_tests/">5. Inferences about one or two populations</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/07-anova/"><a href="/workshops/biostats/chapters/07-anova/">6. Analysis of Variance (ANOVA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/08-regressions/"><a href="/workshops/biostats/chapters/08-regressions/">7. Simple linear regressions</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/09-correlations/"><a href="/workshops/biostats/chapters/09-correlations/">8. Correlation</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/10-confidence/"><a href="/workshops/biostats/chapters/10-confidence/">9. Confidence intervals</a></li>
            
              
              <li class="" hugo-nav="/workshops/biostats/chapters/11-transformations/"><a href="/workshops/biostats/chapters/11-transformations/">10. Data transformations</a></li>
            
          </details>
          
          </li>
        
          
          
          
          <details  class="">
            <summary class="" hugo-nav="/workshops/quantecol/"><a href="/workshops/quantecol/">BCB743</a></summary>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/01-data/"><a href="/workshops/quantecol/chapters/01-data/">1. Multivariate data</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/02-biodiversity/"><a href="/workshops/quantecol/chapters/02-biodiversity/">2. Biodiversity</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/03-deep_dive/"><a href="/workshops/quantecol/chapters/03-deep_dive/">3. Deep Dive into Gradients</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/04-env_dist/"><a href="/workshops/quantecol/chapters/04-env_dist/">4. Environmental Distance</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/05-spp_dissimilarity/"><a href="/workshops/quantecol/chapters/05-spp_dissimilarity/">5. Species Dissimilarities</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/06-correlations/"><a href="/workshops/quantecol/chapters/06-correlations/">6. Correlations and Associations</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/08_pca/"><a href="/workshops/quantecol/chapters/08_pca/">8a. Principal Component Analysis (PCA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/08-pca_sdg/"><a href="/workshops/quantecol/chapters/08-pca_sdg/">8b. PCA of WHO SDGs</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/09-ca/"><a href="/workshops/quantecol/chapters/09-ca/">9. Correspondence Analysis (CA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/10-pcoa/"><a href="/workshops/quantecol/chapters/10-pcoa/">10. Principal Coordinate Analysis (PCoA)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/11-nmds/"><a href="/workshops/quantecol/chapters/11-nmds/">11a. non-Metric multidimensional scaling (nMDS)</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/11-nmds_diatoms/"><a href="/workshops/quantecol/chapters/11-nmds_diatoms/">11b. nMDS of Mayombo&#39;s diatom data</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/12-constrained_ordination/"><a href="/workshops/quantecol/chapters/12-constrained_ordination/">12. Constrained Ordination</a></li>
            
              
              <li class="" hugo-nav="/workshops/quantecol/chapters/13-cluster_analysis/"><a href="/workshops/quantecol/chapters/13-cluster_analysis/">13. Cluster analysis</a></li>
            
          </details>
          
          </li>
        
        </ul>
    </nav>
  </div>
  <details id="PageTableOfContents">
    <summary><h2 class="mv0 f5 fw7 ttu tracked dib">On this page<h2></summary>
    <div class="pl2 pr0 mh0">
    
    </div>
  </details>
  
</div>

</aside>

<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2022 University of the Western Cape, Cape Town
      <span class="middot-divider"></span>
      Made with <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo Apéro</a></span>.
      <br />
      
Based on <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0">
      <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/ajsmit/" title="github" target="_blank" rel="noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="http://orcid.org/0000-0002-3799-6126" title="orcid" target="_blank" rel="noopener">
      <i class="ai ai-orcid fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.researchgate.net/profile/Albertus-Smit" title="researchgate" target="_blank" rel="noopener">
      <i class="ai ai-researchgate fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://uwc.academia.edu/AlbertusSmit" title="academia" target="_blank" rel="noopener">
      <i class="ai ai-academia fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://scholar.google.co.za/citations?user=ATsBBKoAAAAJ&amp;hl=en" title="google-scholar" target="_blank" rel="noopener">
      <i class="ai ai-google-scholar fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.instagram.com/ajsmit/" title="instagram" target="_blank" rel="noopener">
      <i class="fab fa-instagram fa-lg fa-fw"></i>
    </a>
  
</div>

    </div>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
      <a class="dib pv1 ph2 link" href="/license/" title="License">License</a>
      
      <a class="dib pv1 ph2 link" href="/contact/" title="Contact form">Contact</a>
      
      <a class="dib pv1 ph2 link" href="/contributors/" title="Contributors">Contributors</a>
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>
