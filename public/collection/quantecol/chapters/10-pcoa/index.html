<!DOCTYPE html>
<html lang="en" dir="ltr"><head>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.96.0" />
<title>10. Principal Coordinate Analysis (PCoA) | BCB R Stats Pages</title>


<meta property="twitter:site" content="@ajsmit">
<meta property="twitter:creator" content="@ajsmit">







  
    
  
<meta name="description" content="What you need to know upfront.">


<meta property="og:site_name" content="BCB R Stats Pages">
<meta property="og:title" content="10. Principal Coordinate Analysis (PCoA) | BCB R Stats Pages">
<meta property="og:description" content="What you need to know upfront." />
<meta property="og:type" content="page" />
<meta property="og:url" content="/collection/quantecol/chapters/10-pcoa/" />
<meta property="og:locale" content="en">




    
        <meta property="og:image" content="/img/papillons.jpg" >
        <meta property="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="/img/papillons.jpg" >
    
  <meta itemprop="name" content="10. Principal Coordinate Analysis (PCoA)">
<meta itemprop="description" content="Rather than using raw data as in a CA, PCoA takes a (dis)similarity matrix as input; in other words, any of the dissimilarities calculated by vegan’s vegdist() function can be used, which is great as they are well-suited to species data. If dissimilarities are Euclidean distances, then PCoA is equal to PCA. Another thing that makes a PCoA more useful is that (dis)similarity matrices calculated from quantitative, semi-quantitative, qualitative, and mixed variables can be handled."><meta itemprop="datePublished" content="2021-01-01T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-01-01T00:00:00+00:00" />
<meta itemprop="wordCount" content="4153">
<meta itemprop="keywords" content="" />
  
  
  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.13dd27d3efb7ed4ad82be3040182ddbf5ab9d3b4d6d01f0ba3930845932fce66.css" integrity="sha256-E90n0&#43;&#43;37UrYK&#43;MEAYLdv1q507TW0B8Lo5MIRZMvzmY=" media="screen">
  
  
  <script src="/panelset.min.8f4cba0107356728f266d94a12a4d18ef504eda8a9a284cda73675bae7884a68.js" type="text/javascript"></script>
  
  
  <script src="/main.min.318ee9c0652bba0149e7503c97e37e638937f3a9cad9233e6d0ba00bf7a46a5e.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container single-series">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="/" title="Home">
      <img src="/img/xaringan-outline.png" class="dib db-l h2 w-auto" alt="BCB R Stats Pages">
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="About AJ Smit">About</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/workshops/" title="BCB Hons">BCB Hons</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/project/" title="Project Portfolio">Projects</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/collection/" title="R Courses">R Courses</a>
      
      
    </div>
  </nav>
</header>


<main class="page-main ph4 pt4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 pr3-l">
      <header class="post-header">
        <h4 class="breadcrumb pb5">

  
    
      
  
    
      
  
    
      
  

    
    
      <a href="/collection/">B.Sc. (Hons.) R modules</a>
    
  

    
    
      <a href="/collection/quantecol/">BCB743</a>
    
  

    
    
      10. Principal Coordinate Analysis (PCoA)
    
  

</h4>




        
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">10. Principal Coordinate Analysis (PCoA)</h1>
        
        <p class="f6 measure lh-copy mv1"></p>
        <p class="f7 db mv0 ttu">January 1, 2021</p>
        
        
      
        
      </header>
      <section class="post-body pt5 pb4">
        


<!--- # Topic 10: Principal Coordinate Analysis (PCoA) --->
<p>Rather than using raw data as in a CA, PCoA takes a (dis)similarity matrix as input; in other words, any of the dissimilarities calculated by <strong>vegan</strong>’s <code>vegdist()</code> function can be used, which is great as they are well-suited to species data. If dissimilarities are Euclidean distances, then PCoA is equal to PCA. Another thing that makes a PCoA more useful is that (dis)similarity matrices calculated from quantitative, semi-quantitative, qualitative, and mixed variables can be handled.</p>
<p>PCoA scaling takes a set of dissimilarities and returns a set of points such that when plotted in 2D or 3D space the distances between the points are approximately equal to the dissimilarities. In other words, it tries to represent species dissimilarities as Euclidian distances.</p>
<div id="set-up-the-analysis-environment" class="section level2">
<h2>Set-up the analysis environment</h2>
<pre class="r"><code>library(tidyverse)
library(vegan)</code></pre>
</div>
<div id="the-doubs-river-data" class="section level2">
<h2>The Doubs River data</h2>
<p>We continue to use the species data:</p>
<pre class="r"><code>spe &lt;- read.csv(&quot;/Users/ajsmit/Dropbox/R/workshops/Quantitative_Ecology/Num_Ecol_R_book_ed1/DoubsSpe.csv&quot;)
spe &lt;- dplyr::select(spe, -1)
spe &lt;- dplyr::slice(spe, -8)</code></pre>
</div>
<div id="calculate-a-suitable-dissimilarity-matrix" class="section level2">
<h2>Calculate a suitable dissimilarity matrix</h2>
<p>You may or may not want to calculate a dissimilarity index upfront (see below). Here I calculate the Bray-Curtis dissimilarity which is appropriate for abundance data:</p>
<pre class="r"><code>spe_bray &lt;- vegdist(spe)</code></pre>
</div>
<div id="do-the-pcoa" class="section level2">
<h2>Do the PCoA</h2>
<!-- The **vegan** function `cmdscale()` can be used for PCoA: -->
<p>The book <em>Numerical Ecology in R</em> uses a built-in function <code>cmdscale()</code> or the function <code>pcoa()</code> in <strong>ape</strong> for its PCoA calculation. The <strong>vegan</strong> function <code>capscale()</code> can also be used for PCoA, and this is the approach I take here. The ‘CAP’ in <code>capscale()</code> stands for ‘Canonical Analysis of Principal Coordinates’. <code>capscale()</code> works differently from <code>rda()</code> or <code>cca()</code> in that we can only specify the input via a formula interface. See <code>?capscale</code> for information. To run a PCoA without constraints we use <code>1</code> on the righthand side of the formula, with the dissimilarity matrix on the left. Here is how:</p>
<pre class="r"><code># spe_pcoa &lt;- cmdscale(spe_bray, k = nrow(spe) - 1, eig = TRUE)
spe_pcoa &lt;- capscale(spe_bray ~ 1)
spe_pcoa</code></pre>
<pre><code>## Call: capscale(formula = spe_bray ~ 1)
## 
##               Inertia Rank
## Total          6.7621     
## Unconstrained  7.0583   17
## Imaginary     -0.2963   11
## Inertia is squared Bray distance 
## 
## Eigenvalues for unconstrained axes:
##  MDS1  MDS2  MDS3  MDS4  MDS5  MDS6  MDS7  MDS8 
## 3.695 1.098 0.710 0.415 0.305 0.192 0.157 0.132 
## (Showing 8 of 17 unconstrained eigenvalues)</code></pre>
<p>When we do a <code>summary()</code> of the output we see that the results are similar to that of PCA and CA, but the <strong>Species scores</strong> are missing because information about original variables (species) are not available. This is due to the fact that in this instance input into <code>capscale()</code> was the square (site × site) dissimilarity matrix produced from the species table, not the raw species table itself. Here is the output:</p>
<pre class="r"><code>summary(spe_pcoa)</code></pre>
<pre><code>## 
## Call:
## capscale(formula = spe_bray ~ 1) 
## 
## Partitioning of squared Bray distance:
##               Inertia Proportion
## Total           7.058          1
## Unconstrained   7.058          1
## 
## Eigenvalues, and their contribution to the squared Bray distance 
## 
## Importance of components:
##                         MDS1   MDS2   MDS3    MDS4    MDS5    MDS6    MDS7
## Eigenvalue            3.6953 1.0985 0.7105 0.41497 0.30456 0.19179 0.15697
## Proportion Explained  0.5235 0.1556 0.1007 0.05879 0.04315 0.02717 0.02224
## Cumulative Proportion 0.5235 0.6792 0.7798 0.83862 0.88177 0.90894 0.93118
##                          MDS8    MDS9   MDS10    MDS11    MDS12   MDS13
## Eigenvalue            0.13191 0.12943 0.08668 0.046158 0.038645 0.02746
## Proportion Explained  0.01869 0.01834 0.01228 0.006539 0.005475 0.00389
## Cumulative Proportion 0.94987 0.96820 0.98048 0.987023 0.992498 0.99639
##                          MDS14    MDS15     MDS16     MDS17
## Eigenvalue            0.013065 0.007088 0.0040395 0.0013006
## Proportion Explained  0.001851 0.001004 0.0005723 0.0001843
## Cumulative Proportion 0.998239 0.999243 0.9998157 1.0000000
## 
## Scaling 2 for species and site scores
## * Species are scaled proportional to eigenvalues
## * Sites are unscaled: weighted dispersion equal on all dimensions
## * General scaling constant of scores:  3.70945 
## 
## 
## Species scores
## 
##       MDS1 MDS2 MDS3 MDS4 MDS5 MDS6
## Dim1                               
## Dim2                               
## Dim3                               
## Dim4                               
## Dim5                               
## Dim6                               
## Dim7                               
## Dim8                               
## Dim9                               
## Dim10                              
## Dim11                              
## Dim12                              
## Dim13                              
## Dim14                              
## Dim15                              
## Dim16                              
## Dim17                              
## 
## 
## Site scores (weighted sums of species scores)
## 
##        MDS1     MDS2     MDS3      MDS4     MDS5      MDS6
## 1  -0.61833  0.47814 -2.68647 -0.008979  0.75432  0.287801
## 2  -0.97007 -0.18831 -0.50647 -0.747940 -0.24523  0.552569
## 3  -0.91095 -0.26725 -0.11086 -0.269204  0.59014  0.495686
## 4  -0.61035 -0.23286  0.24092 -0.369601  0.87393 -0.003802
## 5   0.12850 -0.36697  0.27123 -1.021930  1.00975 -1.813872
## 6  -0.46630  0.07903  0.51793 -0.574116  1.09111  0.175131
## 7  -0.85286  0.04856  0.08616 -0.345653  0.43990  0.118891
## 8  -0.05527  0.49066  0.83491 -2.293328 -1.49393 -0.171486
## 9  -0.56550  0.13337  0.88932 -0.692163  0.27050  0.509773
## 10 -0.84664  0.25300 -0.67671  0.118437 -0.50196 -0.383681
## 11 -0.91233 -0.04658  0.02921  0.193696 -0.79675 -0.020530
## 12 -0.91757 -0.35596 -0.34803  0.860325 -1.07274 -0.143379
## 13 -0.72310 -0.24814  0.33714  1.141654 -0.35503  0.107426
## 14 -0.47027 -0.50795  0.57853  0.697808 -0.30231 -0.444267
## 15 -0.14181 -0.55761  0.65846  0.872479  0.53048 -0.528434
## 16  0.07838 -0.46361  0.58811  0.933646 -0.41813  0.177637
## 17  0.27874 -0.35778  0.64505  0.700157 -0.43702  0.119531
## 18  0.44306 -0.36281  0.68911  0.265521  0.52313  0.656374
## 19  0.77381 -0.35859  0.09935 -0.155020 -0.01502  0.452721
## 20  0.84592 -0.39536 -0.21418 -0.074459  0.11215  0.152485
## 21  0.89761 -0.44152 -0.41707 -0.197719 -0.11940 -0.333680
## 22  0.22493  2.33322  0.02727  0.445114 -0.84537 -1.488871
## 23  0.61758  1.47945  0.13437  0.181825 -0.49401  2.022706
## 24  0.43613  1.64121  0.48842  0.751905  1.60371 -0.426384
## 25  0.83875  0.01829 -0.02959 -0.091501  0.36656  0.905801
## 26  0.89258 -0.32152 -0.38210 -0.156756 -0.04914  0.197682
## 27  0.89317 -0.37681 -0.47566 -0.274907 -0.19793 -0.007757
## 28  0.79006 -0.61545 -0.54558  0.100449 -0.58864 -0.580587
## 29  0.92215 -0.48985 -0.72275  0.010259 -0.23308 -0.585482</code></pre>
<p>We can provide the raw species table instead and request that <code>capscale()</code> calculates the required dissimilarity indices by automagically calling <code>vegdist()</code>. The advantage of this approach is that it adds species scores as weighted sums of (residual) community matrix, whereas only providing the pre-calculated dissimilarity matrix provides no fixed method for adding species scores. <strong>I advocate providing a raw species table to <code>capscale()</code> to retain the species information</strong>. This avoids many problems later on, such as having to calculate the weighted species scores ourselves.</p>
<pre class="r"><code>spe_pcoa &lt;- capscale(spe ~ 1, distance = &quot;bray&quot;)
spe_pcoa</code></pre>
<pre><code>## Call: capscale(formula = spe ~ 1, distance = &quot;bray&quot;)
## 
##               Inertia Rank
## Total          6.7621     
## Unconstrained  7.0583   17
## Imaginary     -0.2963   11
## Inertia is squared Bray distance 
## Species scores projected from &#39;spe&#39; 
## 
## Eigenvalues for unconstrained axes:
##  MDS1  MDS2  MDS3  MDS4  MDS5  MDS6  MDS7  MDS8 
## 3.695 1.098 0.710 0.415 0.305 0.192 0.157 0.132 
## (Showing 8 of 17 unconstrained eigenvalues)</code></pre>
<p><code>summary()</code> now produces a familiar and more complete output:</p>
<pre class="r"><code>summary(spe_pcoa)</code></pre>
<pre><code>## 
## Call:
## capscale(formula = spe ~ 1, distance = &quot;bray&quot;) 
## 
## Partitioning of squared Bray distance:
##               Inertia Proportion
## Total           7.058          1
## Unconstrained   7.058          1
## 
## Eigenvalues, and their contribution to the squared Bray distance 
## 
## Importance of components:
##                         MDS1   MDS2   MDS3    MDS4    MDS5    MDS6    MDS7
## Eigenvalue            3.6953 1.0985 0.7105 0.41497 0.30456 0.19179 0.15697
## Proportion Explained  0.5235 0.1556 0.1007 0.05879 0.04315 0.02717 0.02224
## Cumulative Proportion 0.5235 0.6792 0.7798 0.83862 0.88177 0.90894 0.93118
##                          MDS8    MDS9   MDS10    MDS11    MDS12   MDS13
## Eigenvalue            0.13191 0.12943 0.08668 0.046158 0.038645 0.02746
## Proportion Explained  0.01869 0.01834 0.01228 0.006539 0.005475 0.00389
## Cumulative Proportion 0.94987 0.96820 0.98048 0.987023 0.992498 0.99639
##                          MDS14    MDS15     MDS16     MDS17
## Eigenvalue            0.013065 0.007088 0.0040395 0.0013006
## Proportion Explained  0.001851 0.001004 0.0005723 0.0001843
## Cumulative Proportion 0.998239 0.999243 0.9998157 1.0000000
## 
## Scaling 2 for species and site scores
## * Species are scaled proportional to eigenvalues
## * Sites are unscaled: weighted dispersion equal on all dimensions
## * General scaling constant of scores:  3.70945 
## 
## 
## Species scores
## 
##         MDS1     MDS2     MDS3      MDS4     MDS5       MDS6
## Cogo -0.1806 -0.12166  0.12009  0.318345 -0.20896 -0.0628447
## Satr -0.8126 -0.25562 -0.09466  0.189816  0.03958 -0.0205182
## Phph -0.7065 -0.36074  0.40967  0.148161  0.04256  0.0044487
## Babl -0.4844 -0.40185  0.63024 -0.015441  0.20424  0.0984599
## Thth -0.1828 -0.11133  0.04616  0.308605 -0.30549 -0.0404440
## Teso -0.1110 -0.21839  0.23781  0.435940 -0.10805 -0.0970663
## Chna  0.2912 -0.13557 -0.04331  0.028119 -0.06114  0.0808072
## Pato  0.2740 -0.29530  0.13661  0.259197 -0.04269 -0.0170839
## Lele  0.3080 -0.37006  0.20073  0.081605  0.23066 -0.3057908
## Sqce  0.3846 -0.15729  0.17876 -0.240323 -0.28958 -0.0902284
## Baba  0.5774 -0.45316 -0.07739  0.191930 -0.18527 -0.0243514
## Albi  0.3698 -0.29397 -0.01089  0.179049 -0.14466 -0.0098897
## Gogo  0.6896 -0.38070 -0.05647  0.064552  0.13137 -0.0511734
## Eslu  0.4650 -0.33541 -0.14921 -0.092236  0.17152 -0.2225910
## Pefl  0.4301 -0.36860 -0.08225 -0.056223  0.07008 -0.2628469
## Rham  0.5761 -0.34405 -0.23487  0.010991 -0.16096 -0.0231124
## Legi  0.4925 -0.25771 -0.20414  0.019508 -0.14985  0.0094055
## Scer  0.3579 -0.16837 -0.16318 -0.069449  0.05846 -0.1482742
## Cyca  0.4281 -0.27220 -0.20946  0.020683 -0.11845 -0.0814711
## Titi  0.6089 -0.39474 -0.13588 -0.190483  0.07140 -0.1149085
## Abbr  0.4992 -0.27219 -0.30006 -0.055196 -0.10996 -0.0667655
## Icme  0.3542 -0.20318 -0.27335 -0.035675 -0.13817 -0.1136177
## Gyce  0.6967 -0.22339 -0.32474 -0.034739 -0.11643  0.0801622
## Ruru  0.8579 -0.30169 -0.02533 -0.341579 -0.09109 -0.1013461
## Blbj  0.5909 -0.27102 -0.33322 -0.074650 -0.14314  0.0005328
## Alal  0.9276 -0.01657 -0.20241  0.112213 -0.10829  0.2386945
## Anan  0.4853 -0.27931 -0.24261 -0.007294 -0.14271 -0.0349343
## 
## 
## Site scores (weighted sums of species scores)
## 
##        MDS1     MDS2     MDS3      MDS4     MDS5      MDS6
## 1  -0.61833  0.47814 -2.68647 -0.008979  0.75432  0.287801
## 2  -0.97007 -0.18831 -0.50647 -0.747940 -0.24523  0.552569
## 3  -0.91095 -0.26725 -0.11086 -0.269204  0.59014  0.495686
## 4  -0.61035 -0.23286  0.24092 -0.369601  0.87393 -0.003802
## 5   0.12850 -0.36697  0.27123 -1.021930  1.00975 -1.813872
## 6  -0.46630  0.07903  0.51793 -0.574116  1.09111  0.175131
## 7  -0.85286  0.04856  0.08616 -0.345653  0.43990  0.118891
## 8  -0.05527  0.49066  0.83491 -2.293328 -1.49393 -0.171486
## 9  -0.56550  0.13337  0.88932 -0.692163  0.27050  0.509773
## 10 -0.84664  0.25300 -0.67671  0.118437 -0.50196 -0.383681
## 11 -0.91233 -0.04658  0.02921  0.193696 -0.79675 -0.020530
## 12 -0.91757 -0.35596 -0.34803  0.860325 -1.07274 -0.143379
## 13 -0.72310 -0.24814  0.33714  1.141654 -0.35503  0.107426
## 14 -0.47027 -0.50795  0.57853  0.697808 -0.30231 -0.444267
## 15 -0.14181 -0.55761  0.65846  0.872479  0.53048 -0.528434
## 16  0.07838 -0.46361  0.58811  0.933646 -0.41813  0.177637
## 17  0.27874 -0.35778  0.64505  0.700157 -0.43702  0.119531
## 18  0.44306 -0.36281  0.68911  0.265521  0.52313  0.656374
## 19  0.77381 -0.35859  0.09935 -0.155020 -0.01502  0.452721
## 20  0.84592 -0.39536 -0.21418 -0.074459  0.11215  0.152485
## 21  0.89761 -0.44152 -0.41707 -0.197719 -0.11940 -0.333680
## 22  0.22493  2.33322  0.02727  0.445114 -0.84537 -1.488871
## 23  0.61758  1.47945  0.13437  0.181825 -0.49401  2.022706
## 24  0.43613  1.64121  0.48842  0.751905  1.60371 -0.426384
## 25  0.83875  0.01829 -0.02959 -0.091501  0.36656  0.905801
## 26  0.89258 -0.32152 -0.38210 -0.156756 -0.04914  0.197682
## 27  0.89317 -0.37681 -0.47566 -0.274907 -0.19793 -0.007757
## 28  0.79006 -0.61545 -0.54558  0.100449 -0.58864 -0.580587
## 29  0.92215 -0.48985 -0.72275  0.010259 -0.23308 -0.585482</code></pre>
<p>We can unpack what is inside the results, and there we can see that we can access the eigenvalues as we did for PCA and CA:</p>
<pre class="r"><code># str(spe_pcoa) # not shown due to length of output</code></pre>
<p>The percentage inertia explained by the first three axes is therefore:</p>
<pre class="r"><code>round(sum(spe_pcoa$CA$eig[1:3]) / sum(spe_pcoa$CA$eig) * 100, 2)</code></pre>
<pre><code>## [1] 77.98</code></pre>
<p>See <em>Numerical Ecology in R</em> (pp. 140 to 145) for information about the interpretation of a PCoA and the ordination diagrams shown below.</p>
</div>
<div id="ordination-diagrams" class="section level2">
<h2>Ordination diagrams</h2>
<p>We create the ordination diagrammes as before:</p>
<pre class="r"><code>plot(spe_pcoa, scaling = 1, main = &quot;PCoA fish abundances - biplot scaling 1&quot;)</code></pre>
<p><img src="/collection/quantecol/chapters/10-PCoA_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>plot(spe_pcoa, scaling = 2, main = &quot;PCoA fish abundances - biplot scaling 2&quot;)</code></pre>
<p><img src="/collection/quantecol/chapters/10-PCoA_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<p>Scaling 1 and scaling 2 is the same as in CA.</p>
<p>The plots above work okay, but we can improve them. Note that you can also apply these improvements to PCA and CA ordinations. Let us build plots from scratch:</p>
<pre class="r"><code>pl1 &lt;- ordiplot(spe_pcoa, type = &quot;none&quot;, scaling = 1, main = &quot;PCoA fish abundances - biplot scaling 1&quot;)
points(pl1, &quot;sites&quot;, pch = 21, cex = 1.75, col = &quot;grey80&quot;, bg = &quot;grey80&quot;)
points(pl1, &quot;species&quot;, pch = 21, col = &quot;turquoise&quot;, arrows = TRUE)
text(pl1, &quot;species&quot;, col = &quot;blue4&quot;, cex = 0.9)
text(pl1, &quot;sites&quot;, col = &quot;red4&quot;, cex = 0.9)</code></pre>
<p><img src="/collection/quantecol/chapters/10-PCoA_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>pl2 &lt;- ordiplot(spe_pcoa, type = &quot;none&quot;, scaling = 2, main = &quot;PCoA fish abundances - biplot scaling 2&quot;)
points(pl2, &quot;sites&quot;, pch = 21, cex = 1.75, col = &quot;grey80&quot;, bg = &quot;grey80&quot;)
points(pl2, &quot;species&quot;, pch = 21, col = &quot;turquoise&quot;, arrows = TRUE)
text(pl2, &quot;species&quot;, col = &quot;blue4&quot;, cex = 0.9)
text(pl2, &quot;sites&quot;, col = &quot;red4&quot;, cex = 0.9)</code></pre>
<p><img src="/collection/quantecol/chapters/10-PCoA_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<p>We can also fit response surfaces using <code>ordisurf()</code>:</p>
<pre class="r"><code>require(&#39;viridis&#39;)</code></pre>
<pre><code>## Loading required package: viridis</code></pre>
<pre><code>## Loading required package: viridisLite</code></pre>
<pre class="r"><code>palette(viridis(8))
par(mar = c(4, 4, 0.9, 0.5) + .1, mfrow = c(2, 2))
with(spe, tmp &lt;- ordisurf(spe_pcoa ~ Satr, bubble = 3,
                          family = quasipoisson, knots = 2, col = 6,
                          display = &quot;sites&quot;, main = &quot;Satr&quot;))
abline(h = 0, v = 0, lty = 3)
with(spe, tmp &lt;- ordisurf(spe_pcoa ~ Scer, bubble = 3,
                          family = quasipoisson, knots = 2, col = 6,
                          display = &quot;sites&quot;, main = &quot;Scer&quot;))
abline(h = 0, v = 0, lty = 3)
with(spe, tmp &lt;- ordisurf(spe_pcoa ~ Teso, bubble = 3,
                          family = quasipoisson, knots = 2, col = 6,
                          display = &quot;sites&quot;, main = &quot;Teso&quot;))
abline(h = 0, v = 0, lty = 3)
with(spe, tmp &lt;- ordisurf(spe_pcoa ~ Cogo, bubble = 3,
                          family = quasipoisson, knots = 2, col = 6,
                          display = &quot;sites&quot;, main = &quot;Cogo&quot;))
abline(h = 0, v = 0, lty = 3)

env &lt;- read.csv(&quot;/Users/ajsmit/Dropbox/R/workshops/Quantitative_Ecology/Num_Ecol_R_book_ed1/DoubsEnv.csv&quot;)
env &lt;- dplyr::select(env, -1)
env &lt;- dplyr::slice(env, -8)

(spe_pcoa_env &lt;- envfit(spe_pcoa, env, scaling = 2)) </code></pre>
<pre><code>## 
## ***VECTORS
## 
##         MDS1     MDS2     r2 Pr(&gt;r)    
## dfs  0.99710  0.07609 0.7210  0.001 ***
## alt -0.99807 -0.06208 0.5659  0.001 ***
## slo -0.92225  0.38660 0.1078  0.130    
## flo  0.99746 -0.07129 0.5324  0.001 ***
## pH  -0.42673 -0.90438 0.0480  0.545    
## har  0.98804  0.15417 0.2769  0.018 *  
## pho  0.45343  0.89129 0.6912  0.001 ***
## nit  0.86338  0.50456 0.6117  0.001 ***
## amm  0.42719  0.90416 0.7076  0.001 ***
## oxy -0.76847 -0.63989 0.7639  0.001 ***
## bod  0.43152  0.90210 0.8561  0.001 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## Permutation: free
## Number of permutations: 999</code></pre>
<pre class="r"><code>plot(spe_pcoa_env, col = &quot;grey40&quot;)
plot(spe_pcoa_env, p.max = 0.05, col = &quot;red&quot;)</code></pre>
<p><img src="/collection/quantecol/chapters/10-PCoA_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="handling-mixed-variable-types" class="section level2">
<h2>Handling mixed variable types</h2>
<p>To handle mixed variable types (numerical, nominal, ordinal, binary) we can use the Gower distance. We do not use <strong>vegan</strong> for this, but rather the <code>daisy()</code> function in <strong>cluster</strong>.</p>
<p>I construct a environmental dataset that contains some mixed variables by column binding a dataset of seawater temperatures and a bioregional classificationn of the 58 coastal sections (the seaweed datasets):</p>
<pre class="r"><code>bioreg &lt;- read.csv(&#39;/Users/ajsmit/Dropbox/R/workshops/Quantitative_Ecology/exercises/diversity/bioregions.csv&#39;, header = TRUE)
load(&quot;/Users/ajsmit/Dropbox/R/workshops/Quantitative_Ecology/exercises/diversity/SeaweedEnv.RData&quot;)
E &lt;- cbind(bioreg, env) %&gt;% 
  mutate(spal.prov = factor(spal.prov),
         spal.ecoreg = factor(spal.ecoreg),
         lombard = factor(lombard),
         bolton = factor(bolton))
head(E)</code></pre>
<pre><code>##   spal.prov spal.ecoreg lombard bolton  febMean   febMax   febMed   febX95
## 1       BMP          NE   NamBR    BMP 13.00117 18.72044 12.66004 16.80969
## 2       BMP          NE   NamBR    BMP 13.37950 18.61897 13.18389 17.07242
## 3       BMP          NE   NamBR    BMP 13.36163 17.86458 13.23187 16.61114
## 4       BMP          NE   NamBR    BMP 13.28966 17.12073 13.10284 16.12137
## 5       BMP          NE   NamBR    BMP 12.81128 16.37829 12.40032 15.53240
## 6       BMP          NE   NamBR    BMP 12.40247 15.96730 11.75096 15.21999
##   febRange  augMean   augMin   augMed    augX5 augRange  annMean    annSD
## 1 6.070326 11.75228 9.812431 11.82838 10.12598 2.502093 12.33503 1.255298
## 2 5.889300 11.57731 9.739288 11.61312 10.08165 2.973370 12.38795 1.401646
## 3 5.431383 11.29382 9.619388 11.26842 10.01617 3.084130 12.24332 1.474712
## 4 5.049024 11.13296 9.567049 11.02333 10.03277 2.995822 12.15410 1.505176
## 5 4.977916 11.23448 9.624302 10.99935 10.17375 2.940255 11.94613 1.449530
## 6 5.142721 11.50199 9.757004 11.15880 10.38581 2.925087 11.83773 1.385862
##    annRange    febSD     augSD    annChl    augChl   febChl
## 1 1.2488912 1.625917 0.7665420  2.623040 11.070480 8.884580
## 2 1.8021850 1.753863 0.8969112  4.903870  8.760170 8.401560
## 3 2.0678127 1.703917 0.9408326  3.723187  8.356506 6.718254
## 4 2.1567012 1.593944 0.9393490  4.165980  4.164904 3.727157
## 5 1.5767921 1.517366 0.9542671  8.020257  8.765154 8.786165
## 6 0.9004776 1.501801 0.9768441 12.882601  7.591975 9.160030</code></pre>
<pre class="r"><code>str(E)</code></pre>
<pre><code>## &#39;data.frame&#39;:    58 obs. of  22 variables:
##  $ spal.prov  : Factor w/ 2 levels &quot;AMP&quot;,&quot;BMP&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ spal.ecoreg: Factor w/ 2 levels &quot;ABE&quot;,&quot;NE&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ lombard    : Factor w/ 4 levels &quot;ABR&quot;,&quot;NamBR&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ bolton     : Factor w/ 4 levels &quot;AMP&quot;,&quot;B-ATZ&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ febMean    : num  13 13.4 13.4 13.3 12.8 ...
##  $ febMax     : num  18.7 18.6 17.9 17.1 16.4 ...
##  $ febMed     : num  12.7 13.2 13.2 13.1 12.4 ...
##  $ febX95     : num  16.8 17.1 16.6 16.1 15.5 ...
##  $ febRange   : num  6.07 5.89 5.43 5.05 4.98 ...
##  $ augMean    : num  11.8 11.6 11.3 11.1 11.2 ...
##  $ augMin     : num  9.81 9.74 9.62 9.57 9.62 ...
##  $ augMed     : num  11.8 11.6 11.3 11 11 ...
##  $ augX5      : num  10.1 10.1 10 10 10.2 ...
##  $ augRange   : num  2.5 2.97 3.08 3 2.94 ...
##  $ annMean    : num  12.3 12.4 12.2 12.2 11.9 ...
##  $ annSD      : num  1.26 1.4 1.47 1.51 1.45 ...
##  $ annRange   : num  1.25 1.8 2.07 2.16 1.58 ...
##  $ febSD      : num  1.63 1.75 1.7 1.59 1.52 ...
##  $ augSD      : num  0.767 0.897 0.941 0.939 0.954 ...
##  $ annChl     : num  2.62 4.9 3.72 4.17 8.02 ...
##  $ augChl     : num  11.07 8.76 8.36 4.16 8.77 ...
##  $ febChl     : num  8.88 8.4 6.72 3.73 8.79 ...</code></pre>
<p>Now we calculate the Gower distances and proceed with the PCoA as before:</p>
<pre class="r"><code>library(cluster)

E_gower &lt;- daisy(E, metric = &quot;gower&quot;)
summary(E_gower)</code></pre>
<pre><code>## 1653 dissimilarities, summarized :
##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 0.006058 0.181880 0.344160 0.321890 0.443730 0.724140 
## Metric :  mixed ;  Types = N, N, N, N, I, I, I, I, I, I, I, I, I, I, I, I, I, I, I, I, I, I 
## Number of objects : 58</code></pre>
<pre class="r"><code>E_mat &lt;- as.matrix(E_gower)
E_mat[1:5, 1:5]</code></pre>
<pre><code>##            1          2          3          4          5
## 1 0.00000000 0.03893923 0.05586573 0.09502716 0.06723042
## 2 0.03893923 0.00000000 0.02753347 0.06586077 0.04354363
## 3 0.05586573 0.02753347 0.00000000 0.04284923 0.04719106
## 4 0.09502716 0.06586077 0.04284923 0.00000000 0.06826655
## 5 0.06723042 0.04354363 0.04719106 0.06826655 0.00000000</code></pre>
<pre class="r"><code>E_pcoa &lt;- capscale(E_mat ~ 1)</code></pre>
<pre class="r"><code>summary(E_pcoa)</code></pre>
<pre><code>## 
## Call:
## capscale(formula = E_mat ~ 1) 
## 
## Partitioning of squared Unknown distance:
##               Inertia Proportion
## Total            3.93          1
## Unconstrained    3.93          1
## 
## Eigenvalues, and their contribution to the squared Unknown distance 
## 
## Importance of components:
##                         MDS1   MDS2    MDS3    MDS4    MDS5    MDS6    MDS7
## Eigenvalue            2.2311 1.0530 0.16179 0.11635 0.08678 0.05990 0.05202
## Proportion Explained  0.5678 0.2680 0.04117 0.02961 0.02208 0.01524 0.01324
## Cumulative Proportion 0.5678 0.8358 0.87693 0.90654 0.92863 0.94387 0.95711
##                          MDS8     MDS9    MDS10    MDS11    MDS12    MDS13
## Eigenvalue            0.04274 0.023523 0.019153 0.016634 0.013035 0.010275
## Proportion Explained  0.01088 0.005986 0.004874 0.004233 0.003317 0.002615
## Cumulative Proportion 0.96799 0.973971 0.978845 0.983079 0.986396 0.989011
##                          MDS14    MDS15    MDS16    MDS17    MDS18     MDS19
## Eigenvalue            0.008646 0.006938 0.005866 0.005202 0.004133 0.0033437
## Proportion Explained  0.002200 0.001766 0.001493 0.001324 0.001052 0.0008509
## Cumulative Proportion 0.991211 0.992976 0.994469 0.995793 0.996845 0.9976959
##                           MDS20     MDS21     MDS22    MDS23     MDS24
## Eigenvalue            0.0029563 0.0020816 0.0012713 0.001041 0.0007704
## Proportion Explained  0.0007523 0.0005297 0.0003235 0.000265 0.0001961
## Cumulative Proportion 0.9984482 0.9989779 0.9993015 0.999567 0.9997626
##                           MDS25     MDS26     MDS27
## Eigenvalue            3.718e-04 2.940e-04 2.671e-04
## Proportion Explained  9.463e-05 7.482e-05 6.798e-05
## Cumulative Proportion 9.999e-01 9.999e-01 1.000e+00
## 
## Scaling 2 for species and site scores
## * Species are scaled proportional to eigenvalues
## * Sites are unscaled: weighted dispersion equal on all dimensions
## * General scaling constant of scores:  3.796338 
## 
## 
## Species scores
## 
##       MDS1 MDS2 MDS3 MDS4 MDS5 MDS6
## Dim1                               
## Dim2                               
## Dim3                               
## Dim4                               
## Dim5                               
## Dim6                               
## Dim7                               
## Dim8                               
## Dim9                               
## Dim10                              
## Dim11                              
## Dim12                              
## Dim13                              
## Dim14                              
## Dim15                              
## Dim16                              
## Dim17                              
## Dim18                              
## Dim19                              
## Dim20                              
## Dim21                              
## Dim22                              
## Dim23                              
## Dim24                              
## Dim25                              
## Dim26                              
## Dim27                              
## 
## 
## Site scores (weighted sums of species scores)
## 
##        MDS1     MDS2      MDS3     MDS4     MDS5      MDS6
## 1  -0.79013  0.38166 -0.173768  0.57039  0.79344  0.512755
## 2  -0.76314  0.33143 -0.008178  0.36578  0.49007  0.621427
## 3  -0.73738  0.36386  0.018401  0.31933  0.88666  0.701070
## 4  -0.66926  0.41635  0.127623  0.54880  1.10858  0.163911
## 5  -0.84837  0.39572 -0.244658  0.34424  0.08223  0.499518
## 6  -0.90828  0.39897 -0.218817  0.22404 -0.41377  0.356537
## 7  -0.90231  0.37991 -0.145482  0.31160 -0.28184  0.383509
## 8  -0.80923  0.30610 -0.096777  0.31097 -0.25116  0.324438
## 9  -0.78734  0.25171  0.946921 -0.57939 -0.46261  0.515513
## 10 -0.58270  0.23053 -0.359670 -0.16402 -0.58738  0.476902
## 11 -0.71442  0.36185 -0.290318  0.24433  0.32709 -0.815638
## 12 -0.36490  0.21178 -0.911007 -1.22613  0.31925 -0.727051
## 13 -0.50439  0.26245 -0.607388 -0.81865 -0.28943 -0.620622
## 14 -0.76437  0.30494  0.121796 -0.35247 -0.43075 -0.863628
## 15 -0.70889  0.27643  0.196195 -1.09528 -0.58859 -0.388155
## 16 -0.42903  0.37140  0.405564 -0.24548  0.99327 -1.848863
## 17 -0.19534 -0.59676 -0.343509 -1.05198 -1.14453  0.120568
## 18 -0.15666 -0.55425 -0.348442 -0.59526 -1.34702 -0.141789
## 19 -0.29043 -0.48242 -0.016081  0.73776 -1.02015 -0.580959
## 20 -0.17266 -0.42598  0.198563  0.72814 -0.32142 -0.374266
## 21  0.02952 -0.37952  0.313661  0.26835 -0.11044 -0.892234
## 22  0.13369 -0.49261 -0.119274 -0.06670  0.47179 -0.370090
## 23  0.18214 -0.54008 -0.376209 -0.23140  0.67179 -0.191136
## 24  0.12733 -0.60704 -0.613916 -0.48898  0.47331  0.681587
## 25  0.17306 -0.62154 -0.233602 -0.40928  0.71488  0.092160
## 26  0.17564 -0.57969 -0.192100 -0.10102  0.60207 -0.277074
## 27  0.20567 -0.54798 -0.469060 -0.63026  0.42854  0.478831
## 28  0.24018 -0.57062 -0.712613 -0.31035  0.50948  0.554681
## 29  0.13718 -0.68364 -0.056174 -0.58700  0.31416  0.518307
## 30  0.09218 -0.84749  0.998863 -0.61359  0.69165  0.234583
## 31  0.08014 -0.71330  0.525886 -0.29457  0.28891  0.204325
## 32  0.03536 -0.64566 -0.137076  0.53299 -0.13679  0.338186
## 33  0.17778 -0.56634  0.010451  0.47620  0.08372 -0.527797
## 34  0.25394 -0.56727 -1.000972  0.75481 -0.73685  0.189328
## 35  0.17217 -0.47071  0.144925  0.38725  0.16740 -0.454451
## 36  0.29306 -0.47783 -0.555480  0.20440  0.07281 -0.007826
## 37  0.18878 -0.45133 -0.175750  0.43333 -0.30453  0.070481
## 38  0.09653 -0.48113  0.236846  0.80401 -0.22543 -0.096429
## 39  0.07680 -0.48304  0.407342  0.75242  0.01863 -0.030696
## 40  0.12648 -0.44195  0.313853  0.39177 -0.08224  0.082093
## 41  0.11951 -0.40261  0.587823  0.53382 -0.21173 -0.265631
## 42  0.14108  0.12726  1.095648  0.47804 -0.52415 -0.177298
## 43  0.22753  0.07281  0.978696  0.04637 -0.32799 -0.125217
## 44  0.33066  0.05554  0.934078 -0.35062 -0.11169  0.205007
## 45  0.44087  0.35208  0.898520 -0.64323 -0.04816  0.522269
## 46  0.50897  0.45962  0.894705 -0.60946 -0.09667  0.504342
## 47  0.51160  0.52903  0.810327 -0.34116 -0.06552  0.317509
## 48  0.47022  0.48660  0.188222  0.07088  0.17153  0.027351
## 49  0.54995  0.56383  0.013332 -0.25436  0.08897  0.018211
## 50  0.56927  0.58447 -0.141587  0.29694  0.03737 -0.108186
## 51  0.56577  0.58955 -0.133604  0.36199  0.02937 -0.067712
## 52  0.51035  0.54246 -0.223984  0.26709 -0.01226  0.372927
## 53  0.47042  0.53945 -0.509707  0.18650 -0.61067  1.100291
## 54  0.55955  0.57260 -0.161884 -0.13318  0.12517  0.088924
## 55  0.65060  0.65080 -0.210964 -0.08426  0.09171 -0.178201
## 56  0.74001  0.70556 -0.353213  0.12330 -0.05337 -0.328759
## 57  0.82761  0.75710 -0.516312  0.13168 -0.12845 -0.393144
## 58  0.90767  0.79695 -0.710665  0.07055 -0.12824 -0.424688</code></pre>
<p>We can extract the various kinds of scores for manual plotting.</p>
<div id="integrative-assignment" class="section level3">
<h3>Integrative assignment</h3>
<p>In the light of all the possible analyses of the Doubs River study (i.e. the earlier PCA and CA analyses as well as the nMDS, RDA, CCA, and clustering techniques in the coming week), provide a full analysis of the Doubs River fish community structure study, focusing on:</p>
<ol style="list-style-type: decimal">
<li><p>the environmental drivers,</p></li>
<li><p>the fish community composition, and</p></li>
<li><p>an integrative view of the environmental structuring of the fish community.</p></li>
</ol>
<p>You are welcome to suggest your own analyses, as necessary, to support the approaches already taken in the module. Your analysis must include one or several ordination techniques (with a justification for why they were selected), as well as a clustering approach. The more novelty you bring to the analysis the better for your marks. Critically discuss your findings in the context of the work initially done by Verneaux et al. (2003). Note that a critical discussion necessitates looking at all major findings of Verneaux et al. (2003) in the light of what your own analyses tell you. In doing so, you must support your own reasoning for agreeing or disagreeing by providing substantiating rational reasoning.</p>
<p>A completely novel (and correct) data and theoretical analysis can earn you marks in excess of 100%.</p>
<p>Your analysis must be structured as follows: Introduction (with Aims and Objectives), Methods, Results, Discussion, References (minimum 10 references, all of which were published <em>after</em> 2003). Unlike previous work in the module, this assignment will be submitted as a professionally formatted MS Word document that follows the author guidelines of South African Journal of Botany. The page limit for the full body of work must not exceed 20 pages (minimum 13 pages), with the Figures/Tables not occupying more than 25% of the total page count. In order to professionally arrange the figures (multiple figures per page, and liberal use of subplots), please make use of the <strong>ggarrange</strong> package.</p>
<p><span style="color:red">Submit your assignment by no later than 17:00 on Friday 30 July 2021.</span></p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Verneaux, J., Schmitt, A., Verneaux, V. and Prouteau, C. (2003). Benthic insects and fish of the Doubs River system: typological traits and the development of a species continuum in a theoretically extrapolated watercourse. Hydrobiologia 490, 63–74.</p>
</div>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
    <a class="prev dtc pr2 tl v-top fw6"
    href="/collection/quantecol/chapters/09-ca/">&larr; 9. Correspondence Analysis (CA)</a>
  
  
  
    <a class="next dtc pl2 tr v-top fw6"
    href="/collection/quantecol/chapters/11-nmds/">11a. non-Metric multidimensional scaling (nMDS) &rarr;</a>
  
</div>

      </footer>
    </article>
    
  </section>
</main>

<aside class="page-sidebar" role="complementary">
                         
 











  <img src="/collection/featured-sidebar.jpg" class="db ma0">

                         
 



<div class="flex items-start sticky ph4 pb4 flex-row">
  <div class="w-two-thirds w-50-l ph0">
    <h2 class="mv3 f5 fw7 ttu tracked">
      <a class="no-underline dim" href="/collection/">Outline</a></h2>
    <nav id="SectionTableOfContents" aria-label="SectionTableOfContents">
        <ul>
        
          
          
          
          <details  class="">
            <summary class="" hugo-nav="/collection/intro_r/"><a href="/collection/intro_r/">BCB744 (Intro R)</a></summary>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/02-rstudio/"><a href="/collection/intro_r/chapters/02-rstudio/">1. RStudio and R</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/03-github/"><a href="/collection/intro_r/chapters/03-github/">2. GitHub</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/04-workflow/"><a href="/collection/intro_r/chapters/04-workflow/">3. An R workflow</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/05-graphics/"><a href="/collection/intro_r/chapters/05-graphics/">4. Graphics with ggplot2</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/06-faceting/"><a href="/collection/intro_r/chapters/06-faceting/">5. Faceting figures</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/07-brewing/"><a href="/collection/intro_r/chapters/07-brewing/">6. Brewing colours</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/08-mapping/"><a href="/collection/intro_r/chapters/08-mapping/">7. Mapping with ggplot2</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/09-mapping_style/"><a href="/collection/intro_r/chapters/09-mapping_style/">8. Mapping with style</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/10-mapping_openstreetmap/"><a href="/collection/intro_r/chapters/10-mapping_openstreetmap/">9. Mapping with OpenStreetMap</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/11-tidy/"><a href="/collection/intro_r/chapters/11-tidy/">10. Tidy data</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/12-tidier/"><a href="/collection/intro_r/chapters/12-tidier/">11. Tidier data</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/13-tidiest/"><a href="/collection/intro_r/chapters/13-tidiest/">12. Tidiest data</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/14-recap/"><a href="/collection/intro_r/chapters/14-recap/">13. Recap</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/15-functions/"><a href="/collection/intro_r/chapters/15-functions/">14. Functions by chapter</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/16-base_r/"><a href="/collection/intro_r/chapters/16-base_r/">15. Base R primer</a></li>
            
              
              <li class="" hugo-nav="/collection/intro_r/chapters/17-dates/"><a href="/collection/intro_r/chapters/17-dates/">16. Dates</a></li>
            
          </details>
          
          </li>
        
          
          
          
          <details  class="">
            <summary class="" hugo-nav="/collection/biostats/"><a href="/collection/biostats/">BCB744 (Biostats)</a></summary>
            
              
              <li class="" hugo-nav="/collection/biostats/chapters/02-data/"><a href="/collection/biostats/chapters/02-data/">1. Types of data</a></li>
            
              
              <li class="" hugo-nav="/collection/biostats/chapters/03-descriptive/"><a href="/collection/biostats/chapters/03-descriptive/">2. Central tendency and dispersion</a></li>
            
              
              <li class="" hugo-nav="/collection/biostats/chapters/04-graphics/"><a href="/collection/biostats/chapters/04-graphics/">3. Graphical data displays</a></li>
            
              
              <li class="" hugo-nav="/collection/biostats/chapters/06-t_tests/"><a href="/collection/biostats/chapters/06-t_tests/">5. Inferences about one or two populations</a></li>
            
              
              <li class="" hugo-nav="/collection/biostats/chapters/07-anova/"><a href="/collection/biostats/chapters/07-anova/">6. Analysis of Variance (ANOVA)</a></li>
            
              
              <li class="" hugo-nav="/collection/biostats/chapters/08-regressions/"><a href="/collection/biostats/chapters/08-regressions/">7. Simple linear regressions</a></li>
            
              
              <li class="" hugo-nav="/collection/biostats/chapters/09-correlations/"><a href="/collection/biostats/chapters/09-correlations/">8. Correlation</a></li>
            
              
              <li class="" hugo-nav="/collection/biostats/chapters/10-confidence/"><a href="/collection/biostats/chapters/10-confidence/">9. Confidence intervals</a></li>
            
              
              <li class="" hugo-nav="/collection/biostats/chapters/11-transformations/"><a href="/collection/biostats/chapters/11-transformations/">10. Data transformations</a></li>
            
          </details>
          
          </li>
        
          
          
          
          <details open class="active">
            <summary class="active" hugo-nav="/collection/quantecol/"><a href="/collection/quantecol/">BCB743</a></summary>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/01-data/"><a href="/collection/quantecol/chapters/01-data/">1. Multivariate data</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/02-biodiversity/"><a href="/collection/quantecol/chapters/02-biodiversity/">2. Biodiversity</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/03-deep_dive/"><a href="/collection/quantecol/chapters/03-deep_dive/">3. Deep Dive into Gradients</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/04-env_dist/"><a href="/collection/quantecol/chapters/04-env_dist/">4. Environmental Distance</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/05-spp_dissimilarity/"><a href="/collection/quantecol/chapters/05-spp_dissimilarity/">5. Species Dissimilarities</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/06-correlations/"><a href="/collection/quantecol/chapters/06-correlations/">6. Correlations and Associations</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/08_pca/"><a href="/collection/quantecol/chapters/08_pca/">8a. Principal Component Analysis (PCA)</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/08-pca_sdg/"><a href="/collection/quantecol/chapters/08-pca_sdg/">8b. PCA of WHO SDGs</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/09-ca/"><a href="/collection/quantecol/chapters/09-ca/">9. Correspondence Analysis (CA)</a></li>
            
              
              <li class="active" hugo-nav="/collection/quantecol/chapters/10-pcoa/"><a href="/collection/quantecol/chapters/10-pcoa/">10. Principal Coordinate Analysis (PCoA)</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/11-nmds/"><a href="/collection/quantecol/chapters/11-nmds/">11a. non-Metric multidimensional scaling (nMDS)</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/11-nmds_diatoms/"><a href="/collection/quantecol/chapters/11-nmds_diatoms/">11b. nMDS of Mayombo&#39;s diatom data</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/12-constrained_ordination/"><a href="/collection/quantecol/chapters/12-constrained_ordination/">12. Constrained Ordination</a></li>
            
              
              <li class="" hugo-nav="/collection/quantecol/chapters/13-cluster_analysis/"><a href="/collection/quantecol/chapters/13-cluster_analysis/">13. Cluster analysis</a></li>
            
          </details>
          
          </li>
        
        </ul>
    </nav>
  </div>
  <details id="PageTableOfContents">
    <summary><h2 class="mv0 f5 fw7 ttu tracked dib">On this page<h2></summary>
    <div class="pl2 pr0 mh0">
    
    </div>
  </details>
  
</div>

</aside>

<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2022 University of the Western Cape, Cape Town
      <span class="middot-divider"></span>
      Made with <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo Apéro</a></span>.
      <br />
      
Based on <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0">
      <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/ajsmit/" title="github" target="_blank" rel="noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="http://orcid.org/0000-0002-3799-6126" title="orcid" target="_blank" rel="noopener">
      <i class="ai ai-orcid fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.researchgate.net/profile/Albertus-Smit" title="researchgate" target="_blank" rel="noopener">
      <i class="ai ai-researchgate fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://uwc.academia.edu/AlbertusSmit" title="academia" target="_blank" rel="noopener">
      <i class="ai ai-academia fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://scholar.google.co.za/citations?user=ATsBBKoAAAAJ&amp;hl=en" title="google-scholar" target="_blank" rel="noopener">
      <i class="ai ai-google-scholar fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.instagram.com/ajsmit/" title="instagram" target="_blank" rel="noopener">
      <i class="fab fa-instagram fa-lg fa-fw"></i>
    </a>
  
</div>

    </div>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
      <a class="dib pv1 ph2 link" href="/license/" title="License">License</a>
      
      <a class="dib pv1 ph2 link" href="/contact/" title="Contact form">Contact</a>
      
      <a class="dib pv1 ph2 link" href="/contributors/" title="Contributors">Contributors</a>
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>
