<!DOCTYPE html>
<html lang="en" dir="ltr"><head>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.96.0" />
<title>Detecting Events in Gridded Data | BCB R Stats Pages</title>


<meta property="twitter:site" content="@ajsmit">
<meta property="twitter:creator" content="@ajsmit">







  
    
  
<meta name="description" content="This vignette demonstrates how to detect marine heatwaves (MHWs) in dataframes of gridded data in which each pixel is a separate time series.">


<meta property="og:site_name" content="BCB R Stats Pages">
<meta property="og:title" content="Detecting Events in Gridded Data | BCB R Stats Pages">
<meta property="og:description" content="This vignette demonstrates how to detect marine heatwaves (MHWs) in dataframes of gridded data in which each pixel is a separate time series." />
<meta property="og:type" content="page" />
<meta property="og:url" content="/project/gridded_data/" />
<meta property="og:locale" content="en">




    
        <meta property="og:image" content="/project/gridded_data/featured-hex.jpg" >
        <meta property="twitter:card" content="summary">
        <meta name="twitter:image" content="/project/gridded_data/featured-hex.jpg" >
    
    
  <meta itemprop="name" content="Detecting Events in Gridded Data">
<meta itemprop="description" content="This vignette demonstrates how to detect marine heatwaves (MHWs) in dataframes of gridded data in which each pixel is a separate time series."><meta itemprop="datePublished" content="2022-04-20T00:00:00+00:00" />
<meta itemprop="dateModified" content="2022-04-20T00:00:00+00:00" />
<meta itemprop="wordCount" content="1814"><meta itemprop="image" content="/project/gridded_data/featured-hex.jpg">
<meta itemprop="keywords" content="MHW," />
  
  
  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.13dd27d3efb7ed4ad82be3040182ddbf5ab9d3b4d6d01f0ba3930845932fce66.css" integrity="sha256-E90n0&#43;&#43;37UrYK&#43;MEAYLdv1q507TW0B8Lo5MIRZMvzmY=" media="screen">
  
  
  <script src="/panelset.min.8f4cba0107356728f266d94a12a4d18ef504eda8a9a284cda73675bae7884a68.js" type="text/javascript"></script>
  
  
  <script src="/main.min.318ee9c0652bba0149e7503c97e37e638937f3a9cad9233e6d0ba00bf7a46a5e.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container single">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="/" title="Home">
      <img src="/img/xaringan-outline.png" class="dib db-l h2 w-auto" alt="BCB R Stats Pages">
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="About AJ Smit">About</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/workshops/" title="BCB Hons">BCB Hons</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/project/" title="Project Portfolio">Projects</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/collection/" title="R Courses">R Courses</a>
      
      
    </div>
  </nav>
</header>

<main class="page-main pa4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 ph4-l">
      <header class="post-header">
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">Detecting Events in Gridded Data</h1>
        
        <p class="f6 measure lh-copy mv1">By Robert W Schlegel and AJ Smit in <a href="/categories/oisst">OISST</a>  <a href="/categories/gridded">gridded</a>  <a href="/categories/mhw">MHW</a>  <a href="/categories/mcs">MCS</a>  <a href="/categories/heatwaver">heatwaveR</a>  <a href="/categories/r">R</a>  <a href="/categories/package">package</a> </p>
        <p class="f7 db mv0 ttu">April 20, 2022</p>

      
      <div class="ph0 pt5">
        
    
    
    
      
    
    
    
    
    
      
      
  <a class="btn-links mr2 ba dib" href="https://robwschlegel.github.io/heatwaveR/articles/gridded_event_detection.html" target="_blank" rel="noopener"><i class="fab fa-github fa-lg fa-fw mr2"></i>Repo</a>

    
    
    
    
    
    
    
      
      
  <a class="btn-links mr2 ba dib" href="https://doi.org/10.5281/zenodo.4431715" target="_blank" rel="noopener"><i class="ai ai-zenodo fa-lg fa-fw mr2"></i>heatwaveR</a>


      </div>
      

      </header>
      <section class="post-body pt5 pb4">
        


<div id="overview" class="section level2">
<h2>Overview</h2>
<p>In the previous vignette we saw how to <a href="https://robwschlegel.github.io/heatwaveR/articles/OISST_preparation.html">download and prepare OISST data</a>. In this vignette we will use the subsetted data we downloaded (not global) for our example on how to detect MHWs in gridded data.</p>
<pre class="r"><code>library(dplyr) # For basic data manipulation
library(ggplot2) # For visualising data
library(heatwaveR) # For detecting MHWs
library(tidync) # For easily dealing with NetCDF data
library(doParallel) # For parallel processing</code></pre>
</div>
<div id="loading-data" class="section level2">
<h2>Loading data</h2>
<p>Because we saved our data as an <code>.Rds</code> file, loading it into R is easy.</p>
<pre class="r"><code>OISST &lt;- readRDS(&quot;~/Desktop/OISST_vignette.Rds&quot;)</code></pre>
</div>
<div id="event-detection" class="section level2">
<h2>Event detection</h2>
<div id="two-good-choices-dplyr-vs.-plyr" class="section level3">
<h3>Two good choices: <strong><code>dplyr</code></strong> vs. <strong><code>plyr</code></strong></h3>
<p>When we want to make the same calculation across multiple groups of data within one dataframe we have two good options available to us. The first is to make use of the <code>map()</code> suite of functions found in the <strong><code>purrr</code></strong> package, and now implemented in <strong><code>dplyr</code></strong>. This is a very fast <strong><code>tidyverse</code></strong> friendly approach to splitting up tasks. The other good option is to go back in time a bit and use the <code>ddply()</code> function from the <strong><code>plyr</code></strong> package. This is arguably a better approach as it allows us to very easily use multiple cores to detect the MHWs. The problem with this approach is that one must <em>never</em> load the <strong><code>plyr</code></strong> library directly as it has some fundamental inconsistencies with the <strong><code>tidyverse</code></strong>. We will see below how to perform these two different techniques without causing ourselves any headaches.</p>
<p>It is a little clumsy to use multiple functions at once with the two methods so we will combine the calculations we want to make into one wrapper function.</p>
<pre class="r"><code>event_only &lt;- function(df){
  # First calculate the climatologies
  clim &lt;- ts2clm(data = df, climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2011-01-01&quot;))
  # Then the events
  event &lt;- detect_event(data = clim)
  # Return only the event metric dataframe of results
  return(event$event)
}</code></pre>
<div id="the-dplyr-method" class="section level4">
<h4>The <strong><code>dplyr</code></strong> method</h4>
<p>This method requires no special consideration and is performed just as any other friendly <strong><code>tidyverse</code></strong> code chunk would be.</p>
<pre class="r"><code>system.time(
# First we start by choosing the &#39;OISST&#39; dataframe
MHW_dplyr &lt;- OISST %&gt;% 
  # Then we group the data by the &#39;lon&#39; and &#39;lat&#39; columns
  group_by(lon, lat) %&gt;% 
  # Then we run our MHW detecting function on each group
  group_modify(~event_only(.x))
) # ~123 seconds</code></pre>
<p>Running the above calculations with only one of the 2.8 GHz cores on a modern laptop took ~123 seconds. It must be noted however that a recent update to the <strong><code>dplyr</code></strong> package now allows it to interrogate one’s computer to determine how many cores it has at it’s disposal. It then uses one core at full capacity and the other cores usually at half capacity.</p>
</div>
<div id="the-plyr-technique" class="section level4">
<h4>The <strong><code>plyr</code></strong> technique</h4>
<p>This method requires that we first tell our machine how many of its processor cores to give us for our calculation.</p>
<pre class="r"><code># NB: One should never use ALL available cores, save at least 1 for other essential tasks
# The computer I&#39;m writing this vignette on has 8 cores, so I use 7 here
registerDoParallel(cores = 7)

# Detect events
system.time(
MHW_plyr &lt;- plyr::ddply(.data = OISST, .variables = c(&quot;lon&quot;, &quot;lat&quot;), .fun = event_only, .parallel = TRUE)
) # 33 seconds</code></pre>
<p>The <strong><code>plyr</code></strong> technique took 33 seconds using seven cores. This technique is not seven times faster because when using multiple cores there is a certain amount of loss in efficiency due to the computer needing to remember which results are meant to go where so that it can stitch everything back together again for you. This takes very little memory, but over large jobs it can start to become problematic. Occasionally ‘slippage’ can occur as well where an entire task can be forgotten. This is very rare but does happen. This is partly what makes <strong><code>dplyr</code></strong> a viable option as it does not have this problem. The other reason is that <strong><code>dplyr</code></strong> performs more efficient calculations than <strong><code>plyr</code></strong>. But what if we could have the best of both worlds?</p>
</div>
</div>
<div id="a-harmonious-third-option" class="section level3">
<h3>A harmonious third option</h3>
<p>As one may see above, running these calculations on a very large (or even global) gridded dataset can quickly become very heavy. While running these calculations myself on the global OISST dataset I have found that the fastest option is to combine the two options above. In my workflow I have saved each longitude segment of the global OISST dataset as separate files and use the <strong><code>dplyr</code></strong> method on each individual file, while using the <strong><code>plyr</code></strong> method to be running the multiple calculations on as many files as my core limit will allow. One may not do this the other way around and use <strong><code>dplyr</code></strong> to run multiple <strong><code>plyr</code></strong> calculations at once. This will confuse your computer and likely cause a stack overflow. Which sounds more fun than it actually is… as I have had to learn.</p>
<p>In order to happily combine these two options into one we will need to convert the <strong><code>dplyr</code></strong> code we wrote above into it’s own wrapper function, which we will then call on a stack of files using the <strong><code>plyr</code></strong> technique. Before we do that we must first create the aforementioned stack of files.</p>
<pre class="r"><code>for(i in 1:length(unique(OISST$lon))){
  OISST_sub &lt;- OISST %&gt;% 
    filter(lon == unique(lon)[i])
  saveRDS(object = OISST_sub, file = paste0(&quot;~/Desktop/OISST_lon_&quot;,i,&quot;.Rds&quot;))
}</code></pre>
<p>This may initially seem like an unnecessary extra step, but when one is working with time series data it is necessary to have all of the dates at a given pixel loaded at once. Unless one is working from a server/virtual machine/supercomputer this means that one will often not be able to comfortably hold an entire grid for a study area in memory at once. Having the data accessible as thin strips like this makes life easier. And as we see in the code chunk below it also (arguably) allows us to perform the most efficient calculations on our data.</p>
<pre class="r"><code># The &#39;dplyr&#39; wrapper function to pass to &#39;plyr&#39;
dplyr_wraper &lt;- function(file_name){
  MHW_dplyr &lt;- readRDS(file_name) %&gt;% 
    group_by(lon, lat) %&gt;% 
    group_modify(~event_only(.x))
}
# Create a vector of the files we want to use
OISST_files &lt;- dir(&quot;~/Desktop&quot;, pattern = &quot;OISST_lon_*&quot;, full.names = T)

# Use &#39;plyr&#39; technique to run &#39;dplyr&#39; technique with multiple cores
system.time(
MHW_result &lt;- plyr::ldply(OISST_files, .fun = dplyr_wraper, .parallel = T)
) # 31 seconds

# Save for later use as desired
saveRDS(MHW_result, &quot;~/Desktop/MHW_result.Rds&quot;)</code></pre>
<p>Even though this technique is not much faster computationally, it is much lighter on our memory (RAM) as it only loads one longitude slice of our data at a time. To maximise efficiency even further I would recommend writing out this full workflow in a stand-alone script and then running it using <code>source()</code> directly from an R terminal. The gain in speed here appears nominal, but as one scales this up the speed boost becomes apparent.</p>
<p>As mentioned above, recent changes to how <strong><code>dplyr</code></strong> interacts with one’s computer has perhaps slowed down the <strong><code>plyr</code></strong> + <strong><code>dplyr</code></strong> workflow shown here. It may be now that simply using <strong><code>plyr</code></strong> by itself is the better option. It depends on the number of cores and the amount of RAM that one has available.</p>
</div>
</div>
<div id="case-study" class="section level2">
<h2>Case study</h2>
<p>Because of human-induced climate change, we anticipate that extreme events will occur more frequently and that they will become greater in intensity. Here we investigate this hypothesis by using gridded SST data, which is the only way that we can assess if this trend is unfolding across large ocean regions. Using the gridded 0.25 degree Reynolds OISST, we will detect marine heatwaves (MHWs) around South Africa by applying the <code>detect_event()</code> function pixel-by-pixel to the data we downloaded in <a href="https://robwschlegel.github.io/heatwaveR/articles/OISST_preparation.html">the previous vignette</a>. After detecting the events, we will fit a generalised linear model (GLM) to each pixel to calculate rates of change in some MHW metrics, and then plot the estimated trends.</p>
<div id="trend-detection" class="section level3">
<h3>Trend detection</h3>
<p>With our MHW detected we will now look at how to fit some GLMs to the results in order to determine long-term trends in MHW occurrence.</p>
<p>Up first we see how to calculate the number of events that occurred per pixel.</p>
<pre class="r"><code># summarise the number of unique longitude, latitude and year combination:
OISST_n &lt;- MHW_result %&gt;% 
  mutate(year = lubridate::year(date_start)) %&gt;% 
  group_by(lon, lat, year) %&gt;% 
  summarise(n = n(), .groups = &quot;drop&quot;) %&gt;% 
  group_by(lon, lat) %&gt;%
  tidyr::complete(year = c(1982:2019)) %&gt;% # Note that these dates may differ
  mutate(n = ifelse(is.na(n), 0, n))
head(OISST_n)</code></pre>
<p>Then we specify the particulars of the GLM we are going to use.</p>
<pre class="r"><code>lin_fun &lt;- function(ev) {
  mod1 &lt;- glm(n ~ year, family = poisson(link = &quot;log&quot;), data = ev)
  # extract slope coefficient and its p-value
  tr &lt;- data.frame(slope = summary(mod1)$coefficients[2,1],
                   p = summary(mod1)$coefficients[2,4])
  return(tr)
}</code></pre>
<p>Lastly we make the calculations.</p>
<pre class="r"><code>OISST_nTrend &lt;- plyr::ddply(OISST_n, c(&quot;lon&quot;, &quot;lat&quot;), lin_fun, .parallel = T)
OISST_nTrend$pval &lt;- cut(OISST_nTrend$p, breaks = c(0, 0.001, 0.01, 0.05, 1))
head(OISST_nTrend)</code></pre>
</div>
<div id="visualising-the-results" class="section level3">
<h3>Visualising the results</h3>
<p>Let’s finish this vignette by visualising the long-term trends in the annual occurrence of MHWs per pixel in the chosen study area. First we will grab the base global map from the <strong><code>maps</code></strong> package.</p>
<pre class="r"><code># The base map
map_base &lt;- ggplot2::fortify(maps::map(fill = TRUE, plot = FALSE)) %&gt;% 
  dplyr::rename(lon = long)</code></pre>
<p>Then we will create two maps that we will stick together using <strong><code>ggpubr</code></strong>. The first map will show the slope of the count of events detected per year over time as shades of red, and the second map will show the significance (<em>p</em>-value) of these trends in shades of grey.</p>
<pre class="r"><code>map_slope &lt;- ggplot(OISST_nTrend, aes(x = lon, y = lat)) +
  geom_rect(size = 0.2, fill = NA,
       aes(xmin = lon - 0.1, xmax = lon + 0.1, ymin = lat - 0.1, ymax = lat + 0.1,
           colour = pval)) +
  geom_raster(aes(fill = slope), interpolate = FALSE, alpha = 0.9) +
  scale_fill_gradient2(name = &quot;count/year (slope)&quot;, high = &quot;red&quot;, mid = &quot;white&quot;,
                       low = &quot;darkblue&quot;, midpoint = 0,
                       guide = guide_colourbar(direction = &quot;horizontal&quot;,
                                               title.position = &quot;top&quot;)) +
  scale_colour_manual(breaks = c(&quot;(0,0.001]&quot;, &quot;(0.001,0.01]&quot;, &quot;(0.01,0.05]&quot;, &quot;(0.05,1]&quot;),
                      values = c(&quot;firebrick1&quot;, &quot;firebrick2&quot;, &quot;firebrick3&quot;, &quot;white&quot;),
                      name = &quot;p-value&quot;, guide = FALSE) +
  geom_polygon(data = map_base, aes(group = group), 
               colour = NA, fill = &quot;grey80&quot;) +
  coord_fixed(ratio = 1, xlim = c(13.0, 23.0), ylim = c(-33, -42), expand = TRUE) +
  labs(x = &quot;&quot;, y = &quot;&quot;) +
  theme_bw() +
  theme(legend.position = &quot;bottom&quot;)

map_p &lt;- ggplot(OISST_nTrend, aes(x = lon, y = lat)) +
  geom_raster(aes(fill = pval), interpolate = FALSE) +
  scale_fill_manual(breaks = c(&quot;(0,0.001]&quot;, &quot;(0.001,0.01]&quot;, &quot;(0.01,0.05]&quot;,
                               &quot;(0.05,0.1]&quot;, &quot;(0.1,0.5]&quot;, &quot;(0.5,1]&quot;),
                    values = c(&quot;black&quot;, &quot;grey20&quot;, &quot;grey40&quot;,
                               &quot;grey80&quot;, &quot;grey90&quot;, &quot;white&quot;),
                    name = &quot;p-value&quot;,
                    guide = guide_legend(direction = &quot;horizontal&quot;,
                                               title.position = &quot;top&quot;)) +
  geom_polygon(data = map_base, aes(group = group), 
               colour = NA, fill = &quot;grey80&quot;) +
  coord_fixed(ratio = 1, xlim = c(13.0, 23.0), ylim = c(-33, -42), expand = TRUE) +
  labs(x = &quot;&quot;, y = &quot;&quot;) +
  theme_bw() +
  theme(legend.position = &quot;bottom&quot;)

map_both &lt;- ggpubr::ggarrange(map_slope, map_p, align = &quot;hv&quot;)
map_both</code></pre>
<p>From the figure above we may see that the entire study area shows significant (<em>p</em>&lt;= 0.05) increases in the count of MHWs per year. This is generally the case for the entire globe. Not shown here is the significant increase in the intensity of MHWs as well.</p>
</div>
</div>

        
        <details closed class="f6 fw7 input-reset">
  <dl class="f6 lh-copy">
    <dt class="fw7">Posted on:</dt>
    <dd class="fw5 ml0">April 20, 2022</dd>
  </dl>
  <dl class="f6 lh-copy">
    <dt class="fw7">Length:</dt>
    <dd class="fw5 ml0">9 minute read, 1814 words</dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Categories:</dt>
    <dd class="fw5 ml0"> <a href="/categories/oisst">OISST</a>  <a href="/categories/gridded">gridded</a>  <a href="/categories/mhw">MHW</a>  <a href="/categories/mcs">MCS</a>  <a href="/categories/heatwaver">heatwaveR</a>  <a href="/categories/r">R</a>  <a href="/categories/package">package</a> </dd>
  </dl>
  
  
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Tags:</dt>
    <dd class="fw5 ml0"> <a href="/tags/mhw">MHW</a> </dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">See Also:</dt>
    
    <dd class="fw5 ml0"><a href="/project/oisst_prep/">Downloading and Preparing NOAA OISST Data</a></dd>
    
    <dd class="fw5 ml0"><a href="/project/basic_mhw_mcs/">Basic Detection and Visualisation of Events</a></dd>
    
  </dl>
</details>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
    <a class="prev dtc pr2 tl v-top fw6"
    href="/project/oisst_prep/">&larr; Downloading and Preparing NOAA OISST Data</a>
  
  
  
</div>

      </footer>
    </article>
    
  </section>
</main>
<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2022 University of the Western Cape, Cape Town
      <span class="middot-divider"></span>
      Made with <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo Apéro</a></span>.
      <br />
      
Based on <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0">
      <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/ajsmit/" title="github" target="_blank" rel="noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="http://orcid.org/0000-0002-3799-6126" title="orcid" target="_blank" rel="noopener">
      <i class="ai ai-orcid fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.researchgate.net/profile/Albertus-Smit" title="researchgate" target="_blank" rel="noopener">
      <i class="ai ai-researchgate fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://uwc.academia.edu/AlbertusSmit" title="academia" target="_blank" rel="noopener">
      <i class="ai ai-academia fa-lg fa-fw"></i>
    </a>
  
    
    
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://scholar.google.co.za/citations?user=ATsBBKoAAAAJ&amp;hl=en" title="google-scholar" target="_blank" rel="noopener">
      <i class="ai ai-google-scholar fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.instagram.com/ajsmit/" title="instagram" target="_blank" rel="noopener">
      <i class="fab fa-instagram fa-lg fa-fw"></i>
    </a>
  
</div>

    </div>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
      <a class="dib pv1 ph2 link" href="/license/" title="License">License</a>
      
      <a class="dib pv1 ph2 link" href="/contact/" title="Contact form">Contact</a>
      
      <a class="dib pv1 ph2 link" href="/contributors/" title="Contributors">Contributors</a>
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>
